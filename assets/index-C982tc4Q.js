const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./AIPredictionMenu-B8gZhgUO.js","./vendor-DNlG_nFR.js","./utils-DS-Dv-fG.js","./AIPredictionMenu-DHYU_K6L.css","./BettingRecordsMenu-DeWkmIyl.js","./BettingRecordsMenu-CeFcAGUe.css","./NumberExtraction-BTu7BcBC.js","./NumberExtraction-DUeyAe8R.css","./FourCodeMaintenance-DRglBgel.js","./FourCodeMaintenance-NgT8-yLF.css","./KillCodeMaintenance-C9OhsB5V.js","./KillCodeMaintenance-BevLWaEE.css","./FiveCodeMaintenance-jPpJS9Kj.js","./FiveCodeMaintenance-CIKaygDS.css","./CodeMaintenance-BVhY1lWU.js","./CodeMaintenance-IwuKmssX.css","./MatchFourCodeByDanma-D4fMliIz.js","./MatchFourCodeByDanma-CM76nPBO.css","./AdvancedNumberPrediction-Cyd20C6j.js","./AdvancedNumberPrediction-CKcKqyJ3.css","./KillTwoCodeMaintenance-CiFrsKBo.js","./KillTwoCodeMaintenance-D8r-v11Z.css","./DataRecovery-DHtA9pXg.js","./DataRecovery-DPKbRiof.css","./AdvancedDataRecovery-zwdWcX-g.js","./AdvancedDataRecovery-d3FjjMqP.css","./ThreeCodeDeduplication-Bgu3P_LO.js","./ThreeCodeDeduplication-DjSQhm1x.css","./PeriodManagement-DJwzyXpl.js","./PeriodManagement-D-wQkItL.css","./ThreeCodeFilter-IF_a5_Qd.js","./ThreeCodeFilter-CaNR2g1g.css","./NotFound-BUSUCSnz.js","./NotFound-D_8T6Y_X.css"])))=>i.map(i=>d[i]);
var aa=Object.defineProperty,ia=Object.defineProperties;var oa=Object.getOwnPropertyDescriptors;var lt=Object.getOwnPropertySymbols,la=Object.getPrototypeOf,Xn=Object.prototype.hasOwnProperty,Kn=Object.prototype.propertyIsEnumerable,ca=Reflect.get;var Ie=(s,e)=>(e=Symbol[s])?e:Symbol.for("Symbol."+s),ua=s=>{throw TypeError(s)};var Jn=(s,e,t)=>e in s?aa(s,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):s[e]=t,o=(s,e)=>{for(var t in e||(e={}))Xn.call(e,t)&&Jn(s,t,e[t]);if(lt)for(var t of lt(e))Kn.call(e,t)&&Jn(s,t,e[t]);return s},u=(s,e)=>ia(s,oa(e));var F=(s,e)=>{var t={};for(var n in s)Xn.call(s,n)&&e.indexOf(n)<0&&(t[n]=s[n]);if(s!=null&&lt)for(var n of lt(s))e.indexOf(n)<0&&Kn.call(s,n)&&(t[n]=s[n]);return t};var zn=(s,e,t)=>ca(la(s),t,e);var _=(s,e,t)=>new Promise((n,r)=>{var a=p=>{try{l(t.next(p))}catch(d){r(d)}},i=p=>{try{l(t.throw(p))}catch(d){r(d)}},l=p=>p.done?n(p.value):Promise.resolve(p.value).then(a,i);l((t=t.apply(s,e)).next())}),q=function(s,e){this[0]=s,this[1]=e},me=(s,e,t)=>{var n=(i,l,p,d)=>{try{var w=t[i](l),f=(l=w.value)instanceof q,m=w.done;Promise.resolve(f?l[0]:l).then(h=>f?n(i==="return"?i:"next",l[1]?{done:h.done,value:h.value}:h,p,d):p({value:h,done:m})).catch(h=>n("throw",h,p,d))}catch(h){d(h)}},r=i=>a[i]=l=>new Promise((p,d)=>n(i,l,p,d)),a={};return t=t.apply(s,e),a[Ie("asyncIterator")]=()=>a,r("next"),r("throw"),r("return"),a},Qn=s=>{var e=s[Ie("asyncIterator")],t=!1,n,r={};return e==null?(e=s[Ie("iterator")](),n=a=>r[a]=i=>e[a](i)):(e=e.call(s),n=a=>r[a]=i=>{if(t){if(t=!1,a==="throw")throw i;return i}return t=!0,{done:!1,value:new q(new Promise(l=>{var p=e[a](i);p instanceof Object||ua("Object expected"),l(p)}),1)}}),r[Ie("iterator")]=()=>r,n("next"),"throw"in e?n("throw"):r.throw=a=>{throw a},"return"in e&&n("return"),r},G=(s,e,t)=>(e=s[Ie("asyncIterator")])?e.call(s):(s=s[Ie("iterator")](),e={},t=(n,r)=>(r=s[n])&&(e[n]=a=>new Promise((i,l,p)=>(a=r.call(s,a),p=a.done,Promise.resolve(a.value).then(d=>i({value:d,done:p}),l)))),t("next"),t("return"),e);import{c as Ue,a as A,b as ct,d as W,w as B,n as ut,e as ne,t as da,f as ha,r as Gn,o as je,g as fa,h as ma,i as pa,j as ga}from"./vendor-DNlG_nFR.js";import{l as Ss}from"./utils-DS-Dv-fG.js";(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))n(r);new MutationObserver(r=>{for(const a of r)if(a.type==="childList")for(const i of a.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&n(i)}).observe(document,{childList:!0,subtree:!0});function t(r){const a={};return r.integrity&&(a.integrity=r.integrity),r.referrerPolicy&&(a.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?a.credentials="include":r.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function n(r){if(r.ep)return;r.ep=!0;const a=t(r);fetch(r.href,a)}})();const _a="modulepreload",wa=function(s,e){return new URL(s,e).href},Yn={},Y=function(e,t,n){let r=Promise.resolve();if(t&&t.length>0){const i=document.getElementsByTagName("link"),l=document.querySelector("meta[property=csp-nonce]"),p=(l==null?void 0:l.nonce)||(l==null?void 0:l.getAttribute("nonce"));r=Promise.allSettled(t.map(d=>{if(d=wa(d,n),d in Yn)return;Yn[d]=!0;const w=d.endsWith(".css"),f=w?'[rel="stylesheet"]':"";if(!!n)for(let y=i.length-1;y>=0;y--){const C=i[y];if(C.href===d&&(!w||C.rel==="stylesheet"))return}else if(document.querySelector(`link[href="${d}"]${f}`))return;const h=document.createElement("link");if(h.rel=w?"stylesheet":_a,w||(h.as="script"),h.crossOrigin="",h.href=d,p&&h.setAttribute("nonce",p),document.head.appendChild(h),w)return new Promise((y,C)=>{h.addEventListener("load",y),h.addEventListener("error",()=>C(new Error(`Unable to preload CSS for ${d}`)))})}))}function a(i){const l=new Event("vite:preloadError",{cancelable:!0});if(l.payload=i,window.dispatchEvent(l),!l.defaultPrevented)throw i}return r.then(i=>{for(const l of i||[])l.status==="rejected"&&a(l.reason);return e().catch(a)})};function I(s,e,t,n,r){if(typeof e=="function"?s!==e||!0:!e.has(s))throw new TypeError("Cannot write private member to an object whose class did not declare it");return e.set(s,t),t}function c(s,e,t,n){if(t==="a"&&!n)throw new TypeError("Private accessor was defined without a getter");if(typeof e=="function"?s!==e||!n:!e.has(s))throw new TypeError("Cannot read private member from an object whose class did not declare it");return t==="m"?n:t==="a"?n.call(s):n?n.value:e.get(s)}let Rs=function(){const{crypto:s}=globalThis;if(s!=null&&s.randomUUID)return Rs=s.randomUUID.bind(s),s.randomUUID();const e=new Uint8Array(1),t=s?()=>s.getRandomValues(e)[0]:()=>Math.random()*255&255;return"10000000-1000-4000-8000-100000000000".replace(/[018]/g,n=>(+n^t()&15>>+n/4).toString(16))};function ln(s){return typeof s=="object"&&s!==null&&("name"in s&&s.name==="AbortError"||"message"in s&&String(s.message).includes("FetchRequestCanceledException"))}const cn=s=>{if(s instanceof Error)return s;if(typeof s=="object"&&s!==null){try{if(Object.prototype.toString.call(s)==="[object Error]"){const e=new Error(s.message,s.cause?{cause:s.cause}:{});return s.stack&&(e.stack=s.stack),s.cause&&!e.cause&&(e.cause=s.cause),s.name&&(e.name=s.name),e}}catch(e){}try{return new Error(JSON.stringify(s))}catch(e){}}return new Error(s)};class R extends Error{}class Q extends R{constructor(e,t,n,r){super(`${Q.makeMessage(e,t,n)}`),this.status=e,this.headers=r,this.requestID=r==null?void 0:r.get("x-request-id"),this.error=t;const a=t;this.code=a==null?void 0:a.code,this.param=a==null?void 0:a.param,this.type=a==null?void 0:a.type}static makeMessage(e,t,n){const r=t!=null&&t.message?typeof t.message=="string"?t.message:JSON.stringify(t.message):t?JSON.stringify(t):n;return e&&r?`${e} ${r}`:e?`${e} status code (no body)`:r||"(no status code or body)"}static generate(e,t,n,r){if(!e||!r)return new Bt({message:n,cause:cn(t)});const a=t==null?void 0:t.error;return e===400?new xs(e,a,n,r):e===401?new ks(e,a,n,r):e===403?new Cs(e,a,n,r):e===404?new Is(e,a,n,r):e===409?new Es(e,a,n,r):e===422?new Ps(e,a,n,r):e===429?new $s(e,a,n,r):e>=500?new Ms(e,a,n,r):new Q(e,a,n,r)}}class ie extends Q{constructor({message:e}={}){super(void 0,void 0,e||"Request was aborted.",void 0)}}class Bt extends Q{constructor({message:e,cause:t}){super(void 0,void 0,e||"Connection error.",void 0),t&&(this.cause=t)}}class Sn extends Bt{constructor({message:e}={}){super({message:e!=null?e:"Request timed out."})}}class xs extends Q{}class ks extends Q{}class Cs extends Q{}class Is extends Q{}class Es extends Q{}class Ps extends Q{}class $s extends Q{}class Ms extends Q{}class Os extends R{constructor(){super("Could not parse response content as the length limit was reached")}}class Ts extends R{constructor(){super("Could not parse response content as the request was rejected by the content filter")}}class Ve extends Error{constructor(e){super(e)}}const ya=/^[a-z][a-z0-9+.-]*:/i,ba=s=>ya.test(s);let ee=s=>(ee=Array.isArray,ee(s)),Zn=ee;function Ls(s){return typeof s!="object"?{}:s!=null?s:{}}function va(s){if(!s)return!0;for(const e in s)return!1;return!0}function Aa(s,e){return Object.prototype.hasOwnProperty.call(s,e)}function Yt(s){return s!=null&&typeof s=="object"&&!Array.isArray(s)}const Sa=(s,e)=>{if(typeof e!="number"||!Number.isInteger(e))throw new R(`${s} must be an integer`);if(e<0)throw new R(`${s} must be a positive integer`);return e},Ra=s=>{try{return JSON.parse(s)}catch(e){return}},rt=s=>new Promise(e=>setTimeout(e,s)),Oe="6.8.1",xa=()=>typeof window!="undefined"&&typeof window.document!="undefined"&&typeof navigator!="undefined";function ka(){return typeof Deno!="undefined"&&Deno.build!=null?"deno":typeof EdgeRuntime!="undefined"?"edge":Object.prototype.toString.call(typeof globalThis.process!="undefined"?globalThis.process:0)==="[object process]"?"node":"unknown"}const Ca=()=>{var t,n,r,a,i;const s=ka();if(s==="deno")return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":Oe,"X-Stainless-OS":ts(Deno.build.os),"X-Stainless-Arch":es(Deno.build.arch),"X-Stainless-Runtime":"deno","X-Stainless-Runtime-Version":typeof Deno.version=="string"?Deno.version:(n=(t=Deno.version)==null?void 0:t.deno)!=null?n:"unknown"};if(typeof EdgeRuntime!="undefined")return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":Oe,"X-Stainless-OS":"Unknown","X-Stainless-Arch":`other:${EdgeRuntime}`,"X-Stainless-Runtime":"edge","X-Stainless-Runtime-Version":globalThis.process.version};if(s==="node")return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":Oe,"X-Stainless-OS":ts((r=globalThis.process.platform)!=null?r:"unknown"),"X-Stainless-Arch":es((a=globalThis.process.arch)!=null?a:"unknown"),"X-Stainless-Runtime":"node","X-Stainless-Runtime-Version":(i=globalThis.process.version)!=null?i:"unknown"};const e=Ia();return e?{"X-Stainless-Lang":"js","X-Stainless-Package-Version":Oe,"X-Stainless-OS":"Unknown","X-Stainless-Arch":"unknown","X-Stainless-Runtime":`browser:${e.browser}`,"X-Stainless-Runtime-Version":e.version}:{"X-Stainless-Lang":"js","X-Stainless-Package-Version":Oe,"X-Stainless-OS":"Unknown","X-Stainless-Arch":"unknown","X-Stainless-Runtime":"unknown","X-Stainless-Runtime-Version":"unknown"}};function Ia(){if(typeof navigator=="undefined"||!navigator)return null;const s=[{key:"edge",pattern:/Edge(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"ie",pattern:/MSIE(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"ie",pattern:/Trident(?:.*rv\:(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"chrome",pattern:/Chrome(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"firefox",pattern:/Firefox(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"safari",pattern:/(?:Version\W+(\d+)\.(\d+)(?:\.(\d+))?)?(?:\W+Mobile\S*)?\W+Safari/}];for(const{key:e,pattern:t}of s){const n=t.exec(navigator.userAgent);if(n){const r=n[1]||0,a=n[2]||0,i=n[3]||0;return{browser:e,version:`${r}.${a}.${i}`}}}return null}const es=s=>s==="x32"?"x32":s==="x86_64"||s==="x64"?"x64":s==="arm"?"arm":s==="aarch64"||s==="arm64"?"arm64":s?`other:${s}`:"unknown",ts=s=>(s=s.toLowerCase(),s.includes("ios")?"iOS":s==="android"?"Android":s==="darwin"?"MacOS":s==="win32"?"Windows":s==="freebsd"?"FreeBSD":s==="openbsd"?"OpenBSD":s==="linux"?"Linux":s?`Other:${s}`:"Unknown");let dt;const Ea=()=>dt!=null?dt:dt=Ca();function Pa(){if(typeof fetch!="undefined")return fetch;throw new Error("`fetch` is not defined as a global; Either pass `fetch` to the client, `new OpenAI({ fetch })` or polyfill the global, `globalThis.fetch = fetch`")}function Ns(...s){const e=globalThis.ReadableStream;if(typeof e=="undefined")throw new Error("`ReadableStream` is not defined as a global; You will need to polyfill it, `globalThis.ReadableStream = ReadableStream`");return new e(...s)}function Ds(s){let e=Symbol.asyncIterator in s?s[Symbol.asyncIterator]():s[Symbol.iterator]();return Ns({start(){},pull(n){return _(this,null,function*(){const{done:r,value:a}=yield e.next();r?n.close():n.enqueue(a)})},cancel(){return _(this,null,function*(){var n;yield(n=e.return)==null?void 0:n.call(e)})}})}function Fs(s){if(s[Symbol.asyncIterator])return s;const e=s.getReader();return{next(){return _(this,null,function*(){try{const n=yield e.read();return n!=null&&n.done&&e.releaseLock(),n}catch(n){throw e.releaseLock(),n}})},return(){return _(this,null,function*(){const n=e.cancel();return e.releaseLock(),yield n,{done:!0,value:void 0}})},[Symbol.asyncIterator](){return this}}}function $a(s){return _(this,null,function*(){var n,r;if(s===null||typeof s!="object")return;if(s[Symbol.asyncIterator]){yield(r=(n=s[Symbol.asyncIterator]()).return)==null?void 0:r.call(n);return}const e=s.getReader(),t=e.cancel();e.releaseLock(),yield t})}const Ma=({headers:s,body:e})=>({bodyHeaders:{"content-type":"application/json"},body:JSON.stringify(e)}),Ws="RFC3986",Bs=s=>String(s),ns={RFC1738:s=>String(s).replace(/%20/g,"+"),RFC3986:Bs},Oa="RFC1738";let un=(s,e)=>{var t;return un=(t=Object.hasOwn)!=null?t:Function.prototype.call.bind(Object.prototype.hasOwnProperty),un(s,e)};const de=(()=>{const s=[];for(let e=0;e<256;++e)s.push("%"+((e<16?"0":"")+e.toString(16)).toUpperCase());return s})(),Zt=1024,Ta=(s,e,t,n,r)=>{if(s.length===0)return s;let a=s;if(typeof s=="symbol"?a=Symbol.prototype.toString.call(s):typeof s!="string"&&(a=String(s)),t==="iso-8859-1")return escape(a).replace(/%u[0-9a-f]{4}/gi,function(l){return"%26%23"+parseInt(l.slice(2),16)+"%3B"});let i="";for(let l=0;l<a.length;l+=Zt){const p=a.length>=Zt?a.slice(l,l+Zt):a,d=[];for(let w=0;w<p.length;++w){let f=p.charCodeAt(w);if(f===45||f===46||f===95||f===126||f>=48&&f<=57||f>=65&&f<=90||f>=97&&f<=122||r===Oa&&(f===40||f===41)){d[d.length]=p.charAt(w);continue}if(f<128){d[d.length]=de[f];continue}if(f<2048){d[d.length]=de[192|f>>6]+de[128|f&63];continue}if(f<55296||f>=57344){d[d.length]=de[224|f>>12]+de[128|f>>6&63]+de[128|f&63];continue}w+=1,f=65536+((f&1023)<<10|p.charCodeAt(w)&1023),d[d.length]=de[240|f>>18]+de[128|f>>12&63]+de[128|f>>6&63]+de[128|f&63]}i+=d.join("")}return i};function La(s){return!s||typeof s!="object"?!1:!!(s.constructor&&s.constructor.isBuffer&&s.constructor.isBuffer(s))}function ss(s,e){if(ee(s)){const t=[];for(let n=0;n<s.length;n+=1)t.push(e(s[n]));return t}return e(s)}const Hs={brackets(s){return String(s)+"[]"},comma:"comma",indices(s,e){return String(s)+"["+e+"]"},repeat(s){return String(s)}},Us=function(s,e){Array.prototype.push.apply(s,ee(e)?e:[e])};let ht;const J={addQueryPrefix:!1,allowDots:!1,allowEmptyArrays:!1,arrayFormat:"indices",charset:"utf-8",charsetSentinel:!1,delimiter:"&",encode:!0,encodeDotInKeys:!1,encoder:Ta,encodeValuesOnly:!1,format:Ws,formatter:Bs,indices:!1,serializeDate(s){return(ht!=null?ht:ht=Function.prototype.call.bind(Date.prototype.toISOString))(s)},skipNulls:!1,strictNullHandling:!1};function Na(s){return typeof s=="string"||typeof s=="number"||typeof s=="boolean"||typeof s=="symbol"||typeof s=="bigint"}const en={};function js(s,e,t,n,r,a,i,l,p,d,w,f,m,h,y,C,P,v){let k=s,D=v,O=0,T=!1;for(;(D=D.get(en))!==void 0&&!T;){const $=D.get(s);if(O+=1,typeof $!="undefined"){if($===O)throw new RangeError("Cyclic object value");T=!0}typeof D.get(en)=="undefined"&&(O=0)}if(typeof d=="function"?k=d(e,k):k instanceof Date?k=m==null?void 0:m(k):t==="comma"&&ee(k)&&(k=ss(k,function($){return $ instanceof Date?m==null?void 0:m($):$})),k===null){if(a)return p&&!C?p(e,J.encoder,P,"key",h):e;k=""}if(Na(k)||La(k)){if(p){const $=C?e:p(e,J.encoder,P,"key",h);return[(y==null?void 0:y($))+"="+(y==null?void 0:y(p(k,J.encoder,P,"value",h)))]}return[(y==null?void 0:y(e))+"="+(y==null?void 0:y(String(k)))]}const H=[];if(typeof k=="undefined")return H;let U;if(t==="comma"&&ee(k))C&&p&&(k=ss(k,p)),U=[{value:k.length>0?k.join(",")||null:void 0}];else if(ee(d))U=d;else{const $=Object.keys(k);U=w?$.sort(w):$}const L=l?String(e).replace(/\./g,"%2E"):String(e),M=n&&ee(k)&&k.length===1?L+"[]":L;if(r&&ee(k)&&k.length===0)return M+"[]";for(let $=0;$<U.length;++$){const N=U[$],x=typeof N=="object"&&typeof N.value!="undefined"?N.value:k[N];if(i&&x===null)continue;const te=f&&l?N.replace(/\./g,"%2E"):N,Ae=ee(k)?typeof t=="function"?t(M,te):M:M+(f?"."+te:"["+te+"]");v.set(s,O);const oe=new WeakMap;oe.set(en,v),Us(H,js(x,Ae,t,n,r,a,i,l,t==="comma"&&C&&ee(k)?null:p,d,w,f,m,h,y,C,P,oe))}return H}function Da(s=J){if(typeof s.allowEmptyArrays!="undefined"&&typeof s.allowEmptyArrays!="boolean")throw new TypeError("`allowEmptyArrays` option can only be `true` or `false`, when provided");if(typeof s.encodeDotInKeys!="undefined"&&typeof s.encodeDotInKeys!="boolean")throw new TypeError("`encodeDotInKeys` option can only be `true` or `false`, when provided");if(s.encoder!==null&&typeof s.encoder!="undefined"&&typeof s.encoder!="function")throw new TypeError("Encoder has to be a function.");const e=s.charset||J.charset;if(typeof s.charset!="undefined"&&s.charset!=="utf-8"&&s.charset!=="iso-8859-1")throw new TypeError("The charset option must be either utf-8, iso-8859-1, or undefined");let t=Ws;if(typeof s.format!="undefined"){if(!un(ns,s.format))throw new TypeError("Unknown format option provided.");t=s.format}const n=ns[t];let r=J.filter;(typeof s.filter=="function"||ee(s.filter))&&(r=s.filter);let a;if(s.arrayFormat&&s.arrayFormat in Hs?a=s.arrayFormat:"indices"in s?a=s.indices?"indices":"repeat":a=J.arrayFormat,"commaRoundTrip"in s&&typeof s.commaRoundTrip!="boolean")throw new TypeError("`commaRoundTrip` must be a boolean, or absent");const i=typeof s.allowDots=="undefined"?s.encodeDotInKeys?!0:J.allowDots:!!s.allowDots;return{addQueryPrefix:typeof s.addQueryPrefix=="boolean"?s.addQueryPrefix:J.addQueryPrefix,allowDots:i,allowEmptyArrays:typeof s.allowEmptyArrays=="boolean"?!!s.allowEmptyArrays:J.allowEmptyArrays,arrayFormat:a,charset:e,charsetSentinel:typeof s.charsetSentinel=="boolean"?s.charsetSentinel:J.charsetSentinel,commaRoundTrip:!!s.commaRoundTrip,delimiter:typeof s.delimiter=="undefined"?J.delimiter:s.delimiter,encode:typeof s.encode=="boolean"?s.encode:J.encode,encodeDotInKeys:typeof s.encodeDotInKeys=="boolean"?s.encodeDotInKeys:J.encodeDotInKeys,encoder:typeof s.encoder=="function"?s.encoder:J.encoder,encodeValuesOnly:typeof s.encodeValuesOnly=="boolean"?s.encodeValuesOnly:J.encodeValuesOnly,filter:r,format:t,formatter:n,serializeDate:typeof s.serializeDate=="function"?s.serializeDate:J.serializeDate,skipNulls:typeof s.skipNulls=="boolean"?s.skipNulls:J.skipNulls,sort:typeof s.sort=="function"?s.sort:null,strictNullHandling:typeof s.strictNullHandling=="boolean"?s.strictNullHandling:J.strictNullHandling}}function Fa(s,e={}){let t=s;const n=Da(e);let r,a;typeof n.filter=="function"?(a=n.filter,t=a("",t)):ee(n.filter)&&(a=n.filter,r=a);const i=[];if(typeof t!="object"||t===null)return"";const l=Hs[n.arrayFormat],p=l==="comma"&&n.commaRoundTrip;r||(r=Object.keys(t)),n.sort&&r.sort(n.sort);const d=new WeakMap;for(let m=0;m<r.length;++m){const h=r[m];n.skipNulls&&t[h]===null||Us(i,js(t[h],h,l,p,n.allowEmptyArrays,n.strictNullHandling,n.skipNulls,n.encodeDotInKeys,n.encode?n.encoder:null,n.filter,n.sort,n.allowDots,n.serializeDate,n.format,n.formatter,n.encodeValuesOnly,n.charset,d))}const w=i.join(n.delimiter);let f=n.addQueryPrefix===!0?"?":"";return n.charsetSentinel&&(n.charset==="iso-8859-1"?f+="utf8=%26%2310003%3B&":f+="utf8=%E2%9C%93&"),w.length>0?f+w:""}function Wa(s){let e=0;for(const r of s)e+=r.length;const t=new Uint8Array(e);let n=0;for(const r of s)t.set(r,n),n+=r.length;return t}let ft;function Rn(s){let e;return(ft!=null?ft:(e=new globalThis.TextEncoder,ft=e.encode.bind(e)))(s)}let mt;function rs(s){let e;return(mt!=null?mt:(e=new globalThis.TextDecoder,mt=e.decode.bind(e)))(s)}var se,re;class Ht{constructor(){se.set(this,void 0),re.set(this,void 0),I(this,se,new Uint8Array),I(this,re,null)}decode(e){if(e==null)return[];const t=e instanceof ArrayBuffer?new Uint8Array(e):typeof e=="string"?Rn(e):e;I(this,se,Wa([c(this,se,"f"),t]));const n=[];let r;for(;(r=Ba(c(this,se,"f"),c(this,re,"f")))!=null;){if(r.carriage&&c(this,re,"f")==null){I(this,re,r.index);continue}if(c(this,re,"f")!=null&&(r.index!==c(this,re,"f")+1||r.carriage)){n.push(rs(c(this,se,"f").subarray(0,c(this,re,"f")-1))),I(this,se,c(this,se,"f").subarray(c(this,re,"f"))),I(this,re,null);continue}const a=c(this,re,"f")!==null?r.preceding-1:r.preceding,i=rs(c(this,se,"f").subarray(0,a));n.push(i),I(this,se,c(this,se,"f").subarray(r.index)),I(this,re,null)}return n}flush(){return c(this,se,"f").length?this.decode(`
`):[]}}se=new WeakMap,re=new WeakMap;Ht.NEWLINE_CHARS=new Set([`
`,"\r"]);Ht.NEWLINE_REGEXP=/\r\n|[\n\r]/g;function Ba(s,e){for(let r=e!=null?e:0;r<s.length;r++){if(s[r]===10)return{preceding:r,index:r+1,carriage:!1};if(s[r]===13)return{preceding:r,index:r+1,carriage:!0}}return null}function Ha(s){for(let n=0;n<s.length-1;n++){if(s[n]===10&&s[n+1]===10||s[n]===13&&s[n+1]===13)return n+2;if(s[n]===13&&s[n+1]===10&&n+3<s.length&&s[n+2]===13&&s[n+3]===10)return n+4}return-1}const $t={off:0,error:200,warn:300,info:400,debug:500},as=(s,e,t)=>{if(s){if(Aa($t,s))return s;K(t).warn(`${e} was set to ${JSON.stringify(s)}, expected one of ${JSON.stringify(Object.keys($t))}`)}};function Je(){}function pt(s,e,t){return!e||$t[s]>$t[t]?Je:e[s].bind(e)}const Ua={error:Je,warn:Je,info:Je,debug:Je};let is=new WeakMap;function K(s){var a;const e=s.logger,t=(a=s.logLevel)!=null?a:"off";if(!e)return Ua;const n=is.get(e);if(n&&n[0]===t)return n[1];const r={error:pt("error",e,t),warn:pt("warn",e,t),info:pt("info",e,t),debug:pt("debug",e,t)};return is.set(e,[t,r]),r}const Se=s=>(s.options&&(s.options=o({},s.options),delete s.options.headers),s.headers&&(s.headers=Object.fromEntries((s.headers instanceof Headers?[...s.headers]:Object.entries(s.headers)).map(([e,t])=>[e,e.toLowerCase()==="authorization"||e.toLowerCase()==="cookie"||e.toLowerCase()==="set-cookie"?"***":t]))),"retryOfRequestLogID"in s&&(s.retryOfRequestLogID&&(s.retryOf=s.retryOfRequestLogID),delete s.retryOfRequestLogID),s);var qe;class fe{constructor(e,t,n){this.iterator=e,qe.set(this,void 0),this.controller=t,I(this,qe,n)}static fromSSEResponse(e,t,n){let r=!1;const a=n?K(n):console;function i(){return me(this,null,function*(){if(r)throw new R("Cannot iterate over a consumed stream, use `.tee()` to split the stream.");r=!0;let l=!1;try{try{for(var p=G(ja(e,t)),d,w,f;d=!(w=yield new q(p.next())).done;d=!1){const m=w.value;if(!l){if(m.data.startsWith("[DONE]")){l=!0;continue}if(m.event===null||!m.event.startsWith("thread.")){let h;try{h=JSON.parse(m.data)}catch(y){throw a.error("Could not parse message into JSON:",m.data),a.error("From chunk:",m.raw),y}if(h&&h.error)throw new Q(void 0,h.error,void 0,e.headers);yield h}else{let h;try{h=JSON.parse(m.data)}catch(y){throw console.error("Could not parse message into JSON:",m.data),console.error("From chunk:",m.raw),y}if(m.event=="error")throw new Q(void 0,h.error,h.message,void 0);yield{event:m.event,data:h}}}}}catch(w){f=[w]}finally{try{d&&(w=p.return)&&(yield new q(w.call(p)))}finally{if(f)throw f[0]}}l=!0}catch(m){if(ln(m))return;throw m}finally{l||t.abort()}})}return new fe(i,t,n)}static fromReadableStream(e,t,n){let r=!1;function a(){return me(this,null,function*(){const l=new Ht,p=Fs(e);try{for(var d=G(p),w,f,m;w=!(f=yield new q(d.next())).done;w=!1){const h=f.value;for(const y of l.decode(h))yield y}}catch(f){m=[f]}finally{try{w&&(f=d.return)&&(yield new q(f.call(d)))}finally{if(m)throw m[0]}}for(const h of l.flush())yield h})}function i(){return me(this,null,function*(){if(r)throw new R("Cannot iterate over a consumed stream, use `.tee()` to split the stream.");r=!0;let l=!1;try{try{for(var p=G(a()),d,w,f;d=!(w=yield new q(p.next())).done;d=!1){const m=w.value;l||m&&(yield JSON.parse(m))}}catch(w){f=[w]}finally{try{d&&(w=p.return)&&(yield new q(w.call(p)))}finally{if(f)throw f[0]}}l=!0}catch(m){if(ln(m))return;throw m}finally{l||t.abort()}})}return new fe(i,t,n)}[(qe=new WeakMap,Symbol.asyncIterator)](){return this.iterator()}tee(){const e=[],t=[],n=this.iterator(),r=a=>({next:()=>{if(a.length===0){const i=n.next();e.push(i),t.push(i)}return a.shift()}});return[new fe(()=>r(e),this.controller,c(this,qe,"f")),new fe(()=>r(t),this.controller,c(this,qe,"f"))]}toReadableStream(){const e=this;let t;return Ns({start(){return _(this,null,function*(){t=e[Symbol.asyncIterator]()})},pull(r){return _(this,null,function*(){try{const{value:a,done:i}=yield t.next();if(i)return r.close();const l=Rn(JSON.stringify(a)+`
`);r.enqueue(l)}catch(a){r.error(a)}})},cancel(){return _(this,null,function*(){var r;yield(r=t.return)==null?void 0:r.call(t)})}})}}function ja(s,e){return me(this,null,function*(){if(!s.body)throw e.abort(),typeof globalThis.navigator!="undefined"&&globalThis.navigator.product==="ReactNative"?new R("The default react-native fetch implementation does not support streaming. Please use expo/fetch: https://docs.expo.dev/versions/latest/sdk/expo/#expofetch-api"):new R("Attempted to iterate over a response with no body");const t=new Va,n=new Ht,r=Fs(s.body);try{for(var a=G(qa(r)),i,l,p;i=!(l=yield new q(a.next())).done;i=!1){const d=l.value;for(const w of n.decode(d)){const f=t.decode(w);f&&(yield f)}}}catch(l){p=[l]}finally{try{i&&(l=a.return)&&(yield new q(l.call(a)))}finally{if(p)throw p[0]}}for(const d of n.flush()){const w=t.decode(d);w&&(yield w)}})}function qa(s){return me(this,null,function*(){let e=new Uint8Array;try{for(var t=G(s),n,r,a;n=!(r=yield new q(t.next())).done;n=!1){const i=r.value;if(i==null)continue;const l=i instanceof ArrayBuffer?new Uint8Array(i):typeof i=="string"?Rn(i):i;let p=new Uint8Array(e.length+l.length);p.set(e),p.set(l,e.length),e=p;let d;for(;(d=Ha(e))!==-1;)yield e.slice(0,d),e=e.slice(d)}}catch(r){a=[r]}finally{try{n&&(r=t.return)&&(yield new q(r.call(t)))}finally{if(a)throw a[0]}}e.length>0&&(yield e)})}class Va{constructor(){this.event=null,this.data=[],this.chunks=[]}decode(e){if(e.endsWith("\r")&&(e=e.substring(0,e.length-1)),!e){if(!this.event&&!this.data.length)return null;const a={event:this.event,data:this.data.join(`
`),raw:this.chunks};return this.event=null,this.data=[],this.chunks=[],a}if(this.chunks.push(e),e.startsWith(":"))return null;let[t,n,r]=Ja(e,":");return r.startsWith(" ")&&(r=r.substring(1)),t==="event"?this.event=r:t==="data"&&this.data.push(r),null}}function Ja(s,e){const t=s.indexOf(e);return t!==-1?[s.substring(0,t),e,s.substring(t+e.length)]:[s,"",""]}function qs(s,e){return _(this,null,function*(){const{response:t,requestLogID:n,retryOfRequestLogID:r,startTime:a}=e,i=yield _(this,null,function*(){var f;if(e.options.stream)return K(s).debug("response",t.status,t.url,t.headers,t.body),e.options.__streamClass?e.options.__streamClass.fromSSEResponse(t,e.controller,s):fe.fromSSEResponse(t,e.controller,s);if(t.status===204)return null;if(e.options.__binaryResponse)return t;const l=t.headers.get("content-type"),p=(f=l==null?void 0:l.split(";")[0])==null?void 0:f.trim();if((p==null?void 0:p.includes("application/json"))||(p==null?void 0:p.endsWith("+json"))){const m=yield t.json();return Vs(m,t)}return yield t.text()});return K(s).debug(`[${n}] response parsed`,Se({retryOfRequestLogID:r,url:t.url,status:t.status,body:i,durationMs:Date.now()-a})),i})}function Vs(s,e){return!s||typeof s!="object"||Array.isArray(s)?s:Object.defineProperty(s,"_request_id",{value:e.headers.get("x-request-id"),enumerable:!1})}var Xe;class Ut extends Promise{constructor(e,t,n=qs){super(r=>{r(null)}),this.responsePromise=t,this.parseResponse=n,Xe.set(this,void 0),I(this,Xe,e)}_thenUnwrap(e){return new Ut(c(this,Xe,"f"),this.responsePromise,(t,n)=>_(this,null,function*(){return Vs(e(yield this.parseResponse(t,n),n),n.response)}))}asResponse(){return this.responsePromise.then(e=>e.response)}withResponse(){return _(this,null,function*(){const[e,t]=yield Promise.all([this.parse(),this.asResponse()]);return{data:e,response:t,request_id:t.headers.get("x-request-id")}})}parse(){return this.parsedPromise||(this.parsedPromise=this.responsePromise.then(e=>this.parseResponse(c(this,Xe,"f"),e))),this.parsedPromise}then(e,t){return this.parse().then(e,t)}catch(e){return this.parse().catch(e)}finally(e){return this.parse().finally(e)}}Xe=new WeakMap;var gt;class xn{constructor(e,t,n,r){gt.set(this,void 0),I(this,gt,e),this.options=r,this.response=t,this.body=n}hasNextPage(){return this.getPaginatedItems().length?this.nextPageRequestOptions()!=null:!1}getNextPage(){return _(this,null,function*(){const e=this.nextPageRequestOptions();if(!e)throw new R("No next page expected; please check `.hasNextPage()` before calling `.getNextPage()`.");return yield c(this,gt,"f").requestAPIList(this.constructor,e)})}iterPages(){return me(this,null,function*(){let e=this;for(yield e;e.hasNextPage();)e=yield new q(e.getNextPage()),yield e})}[(gt=new WeakMap,Symbol.asyncIterator)](){return me(this,null,function*(){try{for(var e=G(this.iterPages()),t,n,r;t=!(n=yield new q(e.next())).done;t=!1){const a=n.value;for(const i of a.getPaginatedItems())yield i}}catch(n){r=[n]}finally{try{t&&(n=e.return)&&(yield new q(n.call(e)))}finally{if(r)throw r[0]}}})}}class Xa extends Ut{constructor(e,t,n){super(e,t,(r,a)=>_(this,null,function*(){return new n(r,a.response,yield qs(r,a),a.options)}))}[Symbol.asyncIterator](){return me(this,null,function*(){const e=yield new q(this);try{for(var t=G(e),n,r,a;n=!(r=yield new q(t.next())).done;n=!1){const i=r.value;yield i}}catch(r){a=[r]}finally{try{n&&(r=t.return)&&(yield new q(r.call(t)))}finally{if(a)throw a[0]}}})}}class jt extends xn{constructor(e,t,n,r){super(e,t,n,r),this.data=n.data||[],this.object=n.object}getPaginatedItems(){var e;return(e=this.data)!=null?e:[]}nextPageRequestOptions(){return null}}class j extends xn{constructor(e,t,n,r){super(e,t,n,r),this.data=n.data||[],this.has_more=n.has_more||!1}getPaginatedItems(){var e;return(e=this.data)!=null?e:[]}hasNextPage(){return this.has_more===!1?!1:super.hasNextPage()}nextPageRequestOptions(){var n;const e=this.getPaginatedItems(),t=(n=e[e.length-1])==null?void 0:n.id;return t?u(o({},this.options),{query:u(o({},Ls(this.options.query)),{after:t})}):null}}class Mt extends xn{constructor(e,t,n,r){super(e,t,n,r),this.data=n.data||[],this.has_more=n.has_more||!1,this.last_id=n.last_id||""}getPaginatedItems(){var e;return(e=this.data)!=null?e:[]}hasNextPage(){return this.has_more===!1?!1:super.hasNextPage()}nextPageRequestOptions(){const e=this.last_id;return e?u(o({},this.options),{query:u(o({},Ls(this.options.query)),{after:e})}):null}}const Js=()=>{var s;if(typeof File=="undefined"){const{process:e}=globalThis,t=typeof((s=e==null?void 0:e.versions)==null?void 0:s.node)=="string"&&parseInt(e.versions.node.split("."))<20;throw new Error("`File` is not defined as a global, which is required for file uploads."+(t?" Update to Node 20 LTS or newer, or set `globalThis.File` to `import('node:buffer').File`.":""))}};function tt(s,e,t){return Js(),new File(s,e!=null?e:"unknown_file",t)}function At(s){return(typeof s=="object"&&s!==null&&("name"in s&&s.name&&String(s.name)||"url"in s&&s.url&&String(s.url)||"filename"in s&&s.filename&&String(s.filename)||"path"in s&&s.path&&String(s.path))||"").split(/[\\/]/).pop()||void 0}const kn=s=>s!=null&&typeof s=="object"&&typeof s[Symbol.asyncIterator]=="function",os=(s,e)=>_(void 0,null,function*(){return dn(s.body)?u(o({},s),{body:yield Xs(s.body,e)}):s}),Ce=(s,e)=>_(void 0,null,function*(){return u(o({},s),{body:yield Xs(s.body,e)})}),ls=new WeakMap;function Ka(s){const e=typeof s=="function"?s:s.fetch,t=ls.get(e);if(t)return t;const n=_(this,null,function*(){try{const r="Response"in e?e.Response:(yield e("data:,")).constructor,a=new FormData;return a.toString()!==(yield new r(a).text())}catch(r){return!0}});return ls.set(e,n),n}const Xs=(s,e)=>_(void 0,null,function*(){if(!(yield Ka(e)))throw new TypeError("The provided fetch function does not support file uploads with the current global FormData class.");const t=new FormData;return yield Promise.all(Object.entries(s||{}).map(([n,r])=>hn(t,n,r))),t}),Ks=s=>s instanceof Blob&&"name"in s,za=s=>typeof s=="object"&&s!==null&&(s instanceof Response||kn(s)||Ks(s)),dn=s=>{if(za(s))return!0;if(Array.isArray(s))return s.some(dn);if(s&&typeof s=="object"){for(const e in s)if(dn(s[e]))return!0}return!1},hn=(s,e,t)=>_(void 0,null,function*(){if(t!==void 0){if(t==null)throw new TypeError(`Received null for "${e}"; to pass null in FormData, you must use the string 'null'`);if(typeof t=="string"||typeof t=="number"||typeof t=="boolean")s.append(e,String(t));else if(t instanceof Response)s.append(e,tt([yield t.blob()],At(t)));else if(kn(t))s.append(e,tt([yield new Response(Ds(t)).blob()],At(t)));else if(Ks(t))s.append(e,t,At(t));else if(Array.isArray(t))yield Promise.all(t.map(n=>hn(s,e+"[]",n)));else if(typeof t=="object")yield Promise.all(Object.entries(t).map(([n,r])=>hn(s,`${e}[${n}]`,r)));else throw new TypeError(`Invalid value given to form, expected a string, number, boolean, object, Array, File or Blob but got ${t} instead`)}}),zs=s=>s!=null&&typeof s=="object"&&typeof s.size=="number"&&typeof s.type=="string"&&typeof s.text=="function"&&typeof s.slice=="function"&&typeof s.arrayBuffer=="function",Qa=s=>s!=null&&typeof s=="object"&&typeof s.name=="string"&&typeof s.lastModified=="number"&&zs(s),Ga=s=>s!=null&&typeof s=="object"&&typeof s.url=="string"&&typeof s.blob=="function";function Ya(s,e,t){return _(this,null,function*(){if(Js(),s=yield s,Qa(s))return s instanceof File?s:tt([yield s.arrayBuffer()],s.name);if(Ga(s)){const r=yield s.blob();return e||(e=new URL(s.url).pathname.split(/[\\/]/).pop()),tt(yield fn(r),e,t)}const n=yield fn(s);if(e||(e=At(s)),!(t!=null&&t.type)){const r=n.find(a=>typeof a=="object"&&"type"in a&&a.type);typeof r=="string"&&(t=u(o({},t),{type:r}))}return tt(n,e,t)})}function fn(s){return _(this,null,function*(){var i;let e=[];if(typeof s=="string"||ArrayBuffer.isView(s)||s instanceof ArrayBuffer)e.push(s);else if(zs(s))e.push(s instanceof Blob?s:yield s.arrayBuffer());else if(kn(s))try{for(var t=G(s),n,r,a;n=!(r=yield t.next()).done;n=!1){const l=r.value;e.push(...yield fn(l))}}catch(r){a=[r]}finally{try{n&&(r=t.return)&&(yield r.call(t))}finally{if(a)throw a[0]}}else{const l=(i=s==null?void 0:s.constructor)==null?void 0:i.name;throw new Error(`Unexpected data type: ${typeof s}${l?`; constructor: ${l}`:""}${Za(s)}`)}return e})}function Za(s){return typeof s!="object"||s===null?"":`; props: [${Object.getOwnPropertyNames(s).map(t=>`"${t}"`).join(", ")}]`}class S{constructor(e){this._client=e}}function Qs(s){return s.replace(/[^A-Za-z0-9\-._~!$&'()*+,;=:@]+/g,encodeURIComponent)}const cs=Object.freeze(Object.create(null)),ei=(s=Qs)=>function(t,...n){if(t.length===1)return t[0];let r=!1;const a=[],i=t.reduce((w,f,m)=>{var C,P,v;/[?#]/.test(f)&&(r=!0);const h=n[m];let y=(r?encodeURIComponent:s)(""+h);return m!==n.length&&(h==null||typeof h=="object"&&h.toString===((v=Object.getPrototypeOf((P=Object.getPrototypeOf((C=h.hasOwnProperty)!=null?C:cs))!=null?P:cs))==null?void 0:v.toString))&&(y=h+"",a.push({start:w.length+f.length,length:y.length,error:`Value of type ${Object.prototype.toString.call(h).slice(8,-1)} is not a valid path parameter`})),w+f+(m===n.length?"":y)},""),l=i.split(/[?#]/,1)[0],p=new RegExp("(?<=^|\\/)(?:\\.|%2e){1,2}(?=\\/|$)","gi");let d;for(;(d=p.exec(l))!==null;)a.push({start:d.index,length:d[0].length,error:`Value "${d[0]}" can't be safely passed as a path parameter`});if(a.sort((w,f)=>w.start-f.start),a.length>0){let w=0;const f=a.reduce((m,h)=>{const y=" ".repeat(h.start-w),C="^".repeat(h.length);return w=h.start+h.length,m+y+C},"");throw new R(`Path parameters result in path with invalid segments:
${a.map(m=>m.error).join(`
`)}
${i}
${f}`)}return i},g=ei(Qs);let Gs=class extends S{list(e,t={},n){return this._client.getAPIList(g`/chat/completions/${e}/messages`,j,o({query:t},n))}};function Ot(s){return s!==void 0&&"function"in s&&s.function!==void 0}function Cn(s){return(s==null?void 0:s.$brand)==="auto-parseable-response-format"}function at(s){return(s==null?void 0:s.$brand)==="auto-parseable-tool"}function ti(s,e){return!e||!Ys(e)?u(o({},s),{choices:s.choices.map(t=>(Zs(t.message.tool_calls),u(o({},t),{message:o(u(o({},t.message),{parsed:null}),t.message.tool_calls?{tool_calls:t.message.tool_calls}:void 0)})))}):In(s,e)}function In(s,e){const t=s.choices.map(n=>{var r,a;if(n.finish_reason==="length")throw new Os;if(n.finish_reason==="content_filter")throw new Ts;return Zs(n.message.tool_calls),u(o({},n),{message:u(o(o({},n.message),n.message.tool_calls?{tool_calls:(a=(r=n.message.tool_calls)==null?void 0:r.map(i=>si(e,i)))!=null?a:void 0}:void 0),{parsed:n.message.content&&!n.message.refusal?ni(e,n.message.content):null})})});return u(o({},s),{choices:t})}function ni(s,e){var t,n;return((t=s.response_format)==null?void 0:t.type)!=="json_schema"?null:((n=s.response_format)==null?void 0:n.type)==="json_schema"?"$parseRaw"in s.response_format?s.response_format.$parseRaw(e):JSON.parse(e):null}function si(s,e){var n;const t=(n=s.tools)==null?void 0:n.find(r=>{var a;return Ot(r)&&((a=r.function)==null?void 0:a.name)===e.function.name});return u(o({},e),{function:u(o({},e.function),{parsed_arguments:at(t)?t.$parseRaw(e.function.arguments):t!=null&&t.function.strict?JSON.parse(e.function.arguments):null})})}function ri(s,e){var n;if(!s||!("tools"in s)||!s.tools)return!1;const t=(n=s.tools)==null?void 0:n.find(r=>{var a;return Ot(r)&&((a=r.function)==null?void 0:a.name)===e.function.name});return Ot(t)&&(at(t)||(t==null?void 0:t.function.strict)||!1)}function Ys(s){var e,t;return Cn(s.response_format)?!0:(t=(e=s.tools)==null?void 0:e.some(n=>at(n)||n.type==="function"&&n.function.strict===!0))!=null?t:!1}function Zs(s){for(const e of s||[])if(e.type!=="function")throw new R(`Currently only \`function\` tool calls are supported; Received \`${e.type}\``)}function ai(s){for(const e of s!=null?s:[]){if(e.type!=="function")throw new R(`Currently only \`function\` tool types support auto-parsing; Received \`${e.type}\``);if(e.function.strict!==!0)throw new R(`The \`${e.function.name}\` tool is not marked with \`strict: true\`. Only strict function tools can be auto-parsed`)}}const Tt=s=>(s==null?void 0:s.role)==="assistant",er=s=>(s==null?void 0:s.role)==="tool";var mn,St,Rt,Ke,ze,xt,Qe,ge,Ge,Lt,Nt,Te,tr;class En{constructor(){mn.add(this),this.controller=new AbortController,St.set(this,void 0),Rt.set(this,()=>{}),Ke.set(this,()=>{}),ze.set(this,void 0),xt.set(this,()=>{}),Qe.set(this,()=>{}),ge.set(this,{}),Ge.set(this,!1),Lt.set(this,!1),Nt.set(this,!1),Te.set(this,!1),I(this,St,new Promise((e,t)=>{I(this,Rt,e,"f"),I(this,Ke,t,"f")})),I(this,ze,new Promise((e,t)=>{I(this,xt,e,"f"),I(this,Qe,t,"f")})),c(this,St,"f").catch(()=>{}),c(this,ze,"f").catch(()=>{})}_run(e){setTimeout(()=>{e().then(()=>{this._emitFinal(),this._emit("end")},c(this,mn,"m",tr).bind(this))},0)}_connected(){this.ended||(c(this,Rt,"f").call(this),this._emit("connect"))}get ended(){return c(this,Ge,"f")}get errored(){return c(this,Lt,"f")}get aborted(){return c(this,Nt,"f")}abort(){this.controller.abort()}on(e,t){return(c(this,ge,"f")[e]||(c(this,ge,"f")[e]=[])).push({listener:t}),this}off(e,t){const n=c(this,ge,"f")[e];if(!n)return this;const r=n.findIndex(a=>a.listener===t);return r>=0&&n.splice(r,1),this}once(e,t){return(c(this,ge,"f")[e]||(c(this,ge,"f")[e]=[])).push({listener:t,once:!0}),this}emitted(e){return new Promise((t,n)=>{I(this,Te,!0),e!=="error"&&this.once("error",n),this.once(e,t)})}done(){return _(this,null,function*(){I(this,Te,!0),yield c(this,ze,"f")})}_emit(e,...t){if(c(this,Ge,"f"))return;e==="end"&&(I(this,Ge,!0),c(this,xt,"f").call(this));const n=c(this,ge,"f")[e];if(n&&(c(this,ge,"f")[e]=n.filter(r=>!r.once),n.forEach(({listener:r})=>r(...t))),e==="abort"){const r=t[0];!c(this,Te,"f")&&!(n!=null&&n.length)&&Promise.reject(r),c(this,Ke,"f").call(this,r),c(this,Qe,"f").call(this,r),this._emit("end");return}if(e==="error"){const r=t[0];!c(this,Te,"f")&&!(n!=null&&n.length)&&Promise.reject(r),c(this,Ke,"f").call(this,r),c(this,Qe,"f").call(this,r),this._emit("end")}}_emitFinal(){}}St=new WeakMap,Rt=new WeakMap,Ke=new WeakMap,ze=new WeakMap,xt=new WeakMap,Qe=new WeakMap,ge=new WeakMap,Ge=new WeakMap,Lt=new WeakMap,Nt=new WeakMap,Te=new WeakMap,mn=new WeakSet,tr=function(e){if(I(this,Lt,!0),e instanceof Error&&e.name==="AbortError"&&(e=new ie),e instanceof ie)return I(this,Nt,!0),this._emit("abort",e);if(e instanceof R)return this._emit("error",e);if(e instanceof Error){const t=new R(e.message);return t.cause=e,this._emit("error",t)}return this._emit("error",new R(String(e)))};function ii(s){return typeof s.parse=="function"}var Z,pn,Dt,gn,_n,wn,nr,sr;const oi=10;class rr extends En{constructor(){super(...arguments),Z.add(this),this._chatCompletions=[],this.messages=[]}_addChatCompletion(e){var n;this._chatCompletions.push(e),this._emit("chatCompletion",e);const t=(n=e.choices[0])==null?void 0:n.message;return t&&this._addMessage(t),e}_addMessage(e,t=!0){if("content"in e||(e.content=null),this.messages.push(e),t){if(this._emit("message",e),er(e)&&e.content)this._emit("functionToolCallResult",e.content);else if(Tt(e)&&e.tool_calls)for(const n of e.tool_calls)n.type==="function"&&this._emit("functionToolCall",n.function)}}finalChatCompletion(){return _(this,null,function*(){yield this.done();const e=this._chatCompletions[this._chatCompletions.length-1];if(!e)throw new R("stream ended without producing a ChatCompletion");return e})}finalContent(){return _(this,null,function*(){return yield this.done(),c(this,Z,"m",pn).call(this)})}finalMessage(){return _(this,null,function*(){return yield this.done(),c(this,Z,"m",Dt).call(this)})}finalFunctionToolCall(){return _(this,null,function*(){return yield this.done(),c(this,Z,"m",gn).call(this)})}finalFunctionToolCallResult(){return _(this,null,function*(){return yield this.done(),c(this,Z,"m",_n).call(this)})}totalUsage(){return _(this,null,function*(){return yield this.done(),c(this,Z,"m",wn).call(this)})}allChatCompletions(){return[...this._chatCompletions]}_emitFinal(){const e=this._chatCompletions[this._chatCompletions.length-1];e&&this._emit("finalChatCompletion",e);const t=c(this,Z,"m",Dt).call(this);t&&this._emit("finalMessage",t);const n=c(this,Z,"m",pn).call(this);n&&this._emit("finalContent",n);const r=c(this,Z,"m",gn).call(this);r&&this._emit("finalFunctionToolCall",r);const a=c(this,Z,"m",_n).call(this);a!=null&&this._emit("finalFunctionToolCallResult",a),this._chatCompletions.some(i=>i.usage)&&this._emit("totalUsage",c(this,Z,"m",wn).call(this))}_createChatCompletion(e,t,n){return _(this,null,function*(){const r=n==null?void 0:n.signal;r&&(r.aborted&&this.controller.abort(),r.addEventListener("abort",()=>this.controller.abort())),c(this,Z,"m",nr).call(this,t);const a=yield e.chat.completions.create(u(o({},t),{stream:!1}),u(o({},n),{signal:this.controller.signal}));return this._connected(),this._addChatCompletion(In(a,t))})}_runChatCompletion(e,t,n){return _(this,null,function*(){for(const r of t.messages)this._addMessage(r,!1);return yield this._createChatCompletion(e,t,n)})}_runTools(e,t,n){return _(this,null,function*(){var y,C,P;const r="tool",h=t,{tool_choice:a="auto",stream:i}=h,l=F(h,["tool_choice","stream"]),p=typeof a!="string"&&a.type==="function"&&((y=a==null?void 0:a.function)==null?void 0:y.name),{maxChatCompletions:d=oi}=n||{},w=t.tools.map(v=>{if(at(v)){if(!v.$callback)throw new R("Tool given to `.runTools()` that does not have an associated function");return{type:"function",function:{function:v.$callback,name:v.function.name,description:v.function.description||"",parameters:v.function.parameters,parse:v.$parseRaw,strict:!0}}}return v}),f={};for(const v of w)v.type==="function"&&(f[v.function.name||v.function.function.name]=v.function);const m="tools"in t?w.map(v=>v.type==="function"?{type:"function",function:{name:v.function.name||v.function.function.name,parameters:v.function.parameters,description:v.function.description,strict:v.function.strict}}:v):void 0;for(const v of t.messages)this._addMessage(v,!1);for(let v=0;v<d;++v){const D=(C=(yield this._createChatCompletion(e,u(o({},l),{tool_choice:a,tools:m,messages:[...this.messages]}),n)).choices[0])==null?void 0:C.message;if(!D)throw new R("missing message in ChatCompletion response");if(!((P=D.tool_calls)!=null&&P.length))return;for(const O of D.tool_calls){if(O.type!=="function")continue;const T=O.id,{name:H,arguments:U}=O.function,L=f[H];if(L){if(p&&p!==H){const x=`Invalid tool_call: ${JSON.stringify(H)}. ${JSON.stringify(p)} requested. Please try again`;this._addMessage({role:r,tool_call_id:T,content:x});continue}}else{const x=`Invalid tool_call: ${JSON.stringify(H)}. Available options are: ${Object.keys(f).map(te=>JSON.stringify(te)).join(", ")}. Please try again`;this._addMessage({role:r,tool_call_id:T,content:x});continue}let M;try{M=ii(L)?yield L.parse(U):U}catch(x){const te=x instanceof Error?x.message:String(x);this._addMessage({role:r,tool_call_id:T,content:te});continue}const $=yield L.function(M,this),N=c(this,Z,"m",sr).call(this,$);if(this._addMessage({role:r,tool_call_id:T,content:N}),p)return}}})}}Z=new WeakSet,pn=function(){var e;return(e=c(this,Z,"m",Dt).call(this).content)!=null?e:null},Dt=function(){var t,n;let e=this.messages.length;for(;e-- >0;){const r=this.messages[e];if(Tt(r))return u(o({},r),{content:(t=r.content)!=null?t:null,refusal:(n=r.refusal)!=null?n:null})}throw new R("stream ended without producing a ChatCompletionMessage with role=assistant")},gn=function(){var e,t;for(let n=this.messages.length-1;n>=0;n--){const r=this.messages[n];if(Tt(r)&&((e=r==null?void 0:r.tool_calls)!=null&&e.length))return(t=r.tool_calls.filter(a=>a.type==="function").at(-1))==null?void 0:t.function}},_n=function(){for(let e=this.messages.length-1;e>=0;e--){const t=this.messages[e];if(er(t)&&t.content!=null&&typeof t.content=="string"&&this.messages.some(n=>{var r;return n.role==="assistant"&&((r=n.tool_calls)==null?void 0:r.some(a=>a.type==="function"&&a.id===t.tool_call_id))}))return t.content}},wn=function(){const e={completion_tokens:0,prompt_tokens:0,total_tokens:0};for(const{usage:t}of this._chatCompletions)t&&(e.completion_tokens+=t.completion_tokens,e.prompt_tokens+=t.prompt_tokens,e.total_tokens+=t.total_tokens);return e},nr=function(e){if(e.n!=null&&e.n>1)throw new R("ChatCompletion convenience helpers only support n=1 at this time. To use n>1, please use chat.completions.create() directly.")},sr=function(e){return typeof e=="string"?e:e===void 0?"undefined":JSON.stringify(e)};class Pn extends rr{static runTools(e,t,n){const r=new Pn,a=u(o({},n),{headers:u(o({},n==null?void 0:n.headers),{"X-Stainless-Helper-Method":"runTools"})});return r._run(()=>r._runTools(e,t,a)),r}_addMessage(e,t=!0){super._addMessage(e,t),Tt(e)&&e.content&&this._emit("content",e.content)}}const ar=1,ir=2,or=4,lr=8,cr=16,ur=32,dr=64,hr=128,fr=256,mr=hr|fr,pr=cr|ur|mr|dr,gr=ar|ir|pr,_r=or|lr,li=gr|_r,X={STR:ar,NUM:ir,ARR:or,OBJ:lr,NULL:cr,BOOL:ur,NAN:dr,INFINITY:hr,MINUS_INFINITY:fr,INF:mr,SPECIAL:pr,ATOM:gr,COLLECTION:_r,ALL:li};class ci extends Error{}class ui extends Error{}function di(s,e=X.ALL){if(typeof s!="string")throw new TypeError(`expecting str, got ${typeof s}`);if(!s.trim())throw new Error(`${s} is empty`);return hi(s.trim(),e)}const hi=(s,e)=>{const t=s.length;let n=0;const r=m=>{throw new ci(`${m} at position ${n}`)},a=m=>{throw new ui(`${m} at position ${n}`)},i=()=>(f(),n>=t&&r("Unexpected end of input"),s[n]==='"'?l():s[n]==="{"?p():s[n]==="["?d():s.substring(n,n+4)==="null"||X.NULL&e&&t-n<4&&"null".startsWith(s.substring(n))?(n+=4,null):s.substring(n,n+4)==="true"||X.BOOL&e&&t-n<4&&"true".startsWith(s.substring(n))?(n+=4,!0):s.substring(n,n+5)==="false"||X.BOOL&e&&t-n<5&&"false".startsWith(s.substring(n))?(n+=5,!1):s.substring(n,n+8)==="Infinity"||X.INFINITY&e&&t-n<8&&"Infinity".startsWith(s.substring(n))?(n+=8,1/0):s.substring(n,n+9)==="-Infinity"||X.MINUS_INFINITY&e&&1<t-n&&t-n<9&&"-Infinity".startsWith(s.substring(n))?(n+=9,-1/0):s.substring(n,n+3)==="NaN"||X.NAN&e&&t-n<3&&"NaN".startsWith(s.substring(n))?(n+=3,NaN):w()),l=()=>{const m=n;let h=!1;for(n++;n<t&&(s[n]!=='"'||h&&s[n-1]==="\\");)h=s[n]==="\\"?!h:!1,n++;if(s.charAt(n)=='"')try{return JSON.parse(s.substring(m,++n-Number(h)))}catch(y){a(String(y))}else if(X.STR&e)try{return JSON.parse(s.substring(m,n-Number(h))+'"')}catch(y){return JSON.parse(s.substring(m,s.lastIndexOf("\\"))+'"')}r("Unterminated string literal")},p=()=>{n++,f();const m={};try{for(;s[n]!=="}";){if(f(),n>=t&&X.OBJ&e)return m;const h=l();f(),n++;try{const y=i();Object.defineProperty(m,h,{value:y,writable:!0,enumerable:!0,configurable:!0})}catch(y){if(X.OBJ&e)return m;throw y}f(),s[n]===","&&n++}}catch(h){if(X.OBJ&e)return m;r("Expected '}' at end of object")}return n++,m},d=()=>{n++;const m=[];try{for(;s[n]!=="]";)m.push(i()),f(),s[n]===","&&n++}catch(h){if(X.ARR&e)return m;r("Expected ']' at end of array")}return n++,m},w=()=>{if(n===0){s==="-"&&X.NUM&e&&r("Not sure what '-' is");try{return JSON.parse(s)}catch(h){if(X.NUM&e)try{return s[s.length-1]==="."?JSON.parse(s.substring(0,s.lastIndexOf("."))):JSON.parse(s.substring(0,s.lastIndexOf("e")))}catch(y){}a(String(h))}}const m=n;for(s[n]==="-"&&n++;s[n]&&!",]}".includes(s[n]);)n++;n==t&&!(X.NUM&e)&&r("Unterminated number literal");try{return JSON.parse(s.substring(m,n))}catch(h){s.substring(m,n)==="-"&&X.NUM&e&&r("Not sure what '-' is");try{return JSON.parse(s.substring(m,s.lastIndexOf("e")))}catch(y){a(String(y))}}},f=()=>{for(;n<t&&` 
\r	`.includes(s[n]);)n++};return i()},us=s=>di(s,X.ALL^X.NUM);var V,pe,Ee,ye,tn,_t,nn,sn,rn,wt,an,ds;class De extends rr{constructor(e){super(),V.add(this),pe.set(this,void 0),Ee.set(this,void 0),ye.set(this,void 0),I(this,pe,e),I(this,Ee,[])}get currentChatCompletionSnapshot(){return c(this,ye,"f")}static fromReadableStream(e){const t=new De(null);return t._run(()=>t._fromReadableStream(e)),t}static createChatCompletion(e,t,n){const r=new De(t);return r._run(()=>r._runChatCompletion(e,u(o({},t),{stream:!0}),u(o({},n),{headers:u(o({},n==null?void 0:n.headers),{"X-Stainless-Helper-Method":"stream"})}))),r}_createChatCompletion(e,t,n){return _(this,null,function*(){var w;zn(De.prototype,this,"_createChatCompletion");const r=n==null?void 0:n.signal;r&&(r.aborted&&this.controller.abort(),r.addEventListener("abort",()=>this.controller.abort())),c(this,V,"m",tn).call(this);const a=yield e.chat.completions.create(u(o({},t),{stream:!0}),u(o({},n),{signal:this.controller.signal}));this._connected();try{for(var i=G(a),l,p,d;l=!(p=yield i.next()).done;l=!1){const f=p.value;c(this,V,"m",nn).call(this,f)}}catch(p){d=[p]}finally{try{l&&(p=i.return)&&(yield p.call(i))}finally{if(d)throw d[0]}}if((w=a.controller.signal)!=null&&w.aborted)throw new ie;return this._addChatCompletion(c(this,V,"m",wt).call(this))})}_fromReadableStream(e,t){return _(this,null,function*(){var w;const n=t==null?void 0:t.signal;n&&(n.aborted&&this.controller.abort(),n.addEventListener("abort",()=>this.controller.abort())),c(this,V,"m",tn).call(this),this._connected();const r=fe.fromReadableStream(e,this.controller);let a;try{for(var i=G(r),l,p,d;l=!(p=yield i.next()).done;l=!1){const f=p.value;a&&a!==f.id&&this._addChatCompletion(c(this,V,"m",wt).call(this)),c(this,V,"m",nn).call(this,f),a=f.id}}catch(p){d=[p]}finally{try{l&&(p=i.return)&&(yield p.call(i))}finally{if(d)throw d[0]}}if((w=r.controller.signal)!=null&&w.aborted)throw new ie;return this._addChatCompletion(c(this,V,"m",wt).call(this))})}[(pe=new WeakMap,Ee=new WeakMap,ye=new WeakMap,V=new WeakSet,tn=function(){this.ended||I(this,ye,void 0)},_t=function(t){let n=c(this,Ee,"f")[t.index];return n||(n={content_done:!1,refusal_done:!1,logprobs_content_done:!1,logprobs_refusal_done:!1,done_tool_calls:new Set,current_tool_call_index:null},c(this,Ee,"f")[t.index]=n,n)},nn=function(t){var r,a,i,l,p,d,w,f,m,h,y,C,P,v,k,D,O,T,H,U;if(this.ended)return;const n=c(this,V,"m",ds).call(this,t);this._emit("chunk",t,n);for(const L of t.choices){const M=n.choices[L.index];L.delta.content!=null&&((r=M.message)==null?void 0:r.role)==="assistant"&&((a=M.message)!=null&&a.content)&&(this._emit("content",L.delta.content,M.message.content),this._emit("content.delta",{delta:L.delta.content,snapshot:M.message.content,parsed:M.message.parsed})),L.delta.refusal!=null&&((i=M.message)==null?void 0:i.role)==="assistant"&&((l=M.message)!=null&&l.refusal)&&this._emit("refusal.delta",{delta:L.delta.refusal,snapshot:M.message.refusal}),((p=L.logprobs)==null?void 0:p.content)!=null&&((d=M.message)==null?void 0:d.role)==="assistant"&&this._emit("logprobs.content.delta",{content:(w=L.logprobs)==null?void 0:w.content,snapshot:(m=(f=M.logprobs)==null?void 0:f.content)!=null?m:[]}),((h=L.logprobs)==null?void 0:h.refusal)!=null&&((y=M.message)==null?void 0:y.role)==="assistant"&&this._emit("logprobs.refusal.delta",{refusal:(C=L.logprobs)==null?void 0:C.refusal,snapshot:(v=(P=M.logprobs)==null?void 0:P.refusal)!=null?v:[]});const $=c(this,V,"m",_t).call(this,M);M.finish_reason&&(c(this,V,"m",rn).call(this,M),$.current_tool_call_index!=null&&c(this,V,"m",sn).call(this,M,$.current_tool_call_index));for(const N of(k=L.delta.tool_calls)!=null?k:[])$.current_tool_call_index!==N.index&&(c(this,V,"m",rn).call(this,M),$.current_tool_call_index!=null&&c(this,V,"m",sn).call(this,M,$.current_tool_call_index)),$.current_tool_call_index=N.index;for(const N of(D=L.delta.tool_calls)!=null?D:[]){const x=(O=M.message.tool_calls)==null?void 0:O[N.index];x!=null&&x.type&&((x==null?void 0:x.type)==="function"?this._emit("tool_calls.function.arguments.delta",{name:(T=x.function)==null?void 0:T.name,index:N.index,arguments:x.function.arguments,parsed_arguments:x.function.parsed_arguments,arguments_delta:(U=(H=N.function)==null?void 0:H.arguments)!=null?U:""}):(x==null||x.type,void 0))}}},sn=function(t,n){var i,l,p;if(c(this,V,"m",_t).call(this,t).done_tool_calls.has(n))return;const a=(i=t.message.tool_calls)==null?void 0:i[n];if(!a)throw new Error("no tool call snapshot");if(!a.type)throw new Error("tool call snapshot missing `type`");if(a.type==="function"){const d=(p=(l=c(this,pe,"f"))==null?void 0:l.tools)==null?void 0:p.find(w=>Ot(w)&&w.function.name===a.function.name);this._emit("tool_calls.function.arguments.done",{name:a.function.name,index:n,arguments:a.function.arguments,parsed_arguments:at(d)?d.$parseRaw(a.function.arguments):d!=null&&d.function.strict?JSON.parse(a.function.arguments):null})}else a.type},rn=function(t){var r,a;const n=c(this,V,"m",_t).call(this,t);if(t.message.content&&!n.content_done){n.content_done=!0;const i=c(this,V,"m",an).call(this);this._emit("content.done",{content:t.message.content,parsed:i?i.$parseRaw(t.message.content):null})}t.message.refusal&&!n.refusal_done&&(n.refusal_done=!0,this._emit("refusal.done",{refusal:t.message.refusal})),(r=t.logprobs)!=null&&r.content&&!n.logprobs_content_done&&(n.logprobs_content_done=!0,this._emit("logprobs.content.done",{content:t.logprobs.content})),(a=t.logprobs)!=null&&a.refusal&&!n.logprobs_refusal_done&&(n.logprobs_refusal_done=!0,this._emit("logprobs.refusal.done",{refusal:t.logprobs.refusal}))},wt=function(){if(this.ended)throw new R("stream has ended, this shouldn't happen");const t=c(this,ye,"f");if(!t)throw new R("request ended without sending any chunks");return I(this,ye,void 0),I(this,Ee,[]),fi(t,c(this,pe,"f"))},an=function(){var n;const t=(n=c(this,pe,"f"))==null?void 0:n.response_format;return Cn(t)?t:null},ds=function(t){var m,h,C,P,v,k;var n,r,a,i;let l=c(this,ye,"f");const w=t,{choices:p}=w,d=F(w,["choices"]);l?Object.assign(l,d):l=I(this,ye,u(o({},d),{choices:[]}));for(const T of t.choices){const H=T,{delta:U,finish_reason:L,index:M,logprobs:$=null}=H,N=F(H,["delta","finish_reason","index","logprobs"]);let x=l.choices[M];if(x||(x=l.choices[M]=o({finish_reason:L,index:M,message:{},logprobs:$},N)),$)if(!x.logprobs)x.logprobs=Object.assign({},$);else{const f=$,{content:_e,refusal:we}=f,ot=F(f,["content","refusal"]);Object.assign(x.logprobs,ot),_e&&((m=(n=x.logprobs).content)!=null||(n.content=[]),x.logprobs.content.push(..._e)),we&&((h=(r=x.logprobs).refusal)!=null||(r.refusal=[]),x.logprobs.refusal.push(...we))}if(L&&(x.finish_reason=L,c(this,pe,"f")&&Ys(c(this,pe,"f")))){if(L==="length")throw new Os;if(L==="content_filter")throw new Ts}if(Object.assign(x,N),!U)continue;const y=U,{content:te,refusal:Ae,function_call:oe,role:Be,tool_calls:He}=y,Gt=F(y,["content","refusal","function_call","role","tool_calls"]);if(Object.assign(x.message,Gt),Ae&&(x.message.refusal=(x.message.refusal||"")+Ae),Be&&(x.message.role=Be),oe&&(x.message.function_call?(oe.name&&(x.message.function_call.name=oe.name),oe.arguments&&((C=(a=x.message.function_call).arguments)!=null||(a.arguments=""),x.message.function_call.arguments+=oe.arguments)):x.message.function_call=oe),te&&(x.message.content=(x.message.content||"")+te,!x.message.refusal&&c(this,V,"m",an).call(this)&&(x.message.parsed=us(x.message.content))),He){x.message.tool_calls||(x.message.tool_calls=[]);for(const D of He){const O=D,{index:_e,id:we,type:ot,function:ce}=O,ra=F(O,["index","id","type","function"]);const ue=(P=(i=x.message.tool_calls)[_e])!=null?P:i[_e]={};Object.assign(ue,ra),we&&(ue.id=we),ot&&(ue.type=ot),ce&&((k=ue.function)!=null||(ue.function={name:(v=ce.name)!=null?v:"",arguments:""})),ce!=null&&ce.name&&(ue.function.name=ce.name),ce!=null&&ce.arguments&&(ue.function.arguments+=ce.arguments,ri(c(this,pe,"f"),ue)&&(ue.function.parsed_arguments=us(ue.function.arguments)))}}}return l},Symbol.asyncIterator)](){const e=[],t=[];let n=!1;return this.on("chunk",r=>{const a=t.shift();a?a.resolve(r):e.push(r)}),this.on("end",()=>{n=!0;for(const r of t)r.resolve(void 0);t.length=0}),this.on("abort",r=>{n=!0;for(const a of t)a.reject(r);t.length=0}),this.on("error",r=>{n=!0;for(const a of t)a.reject(r);t.length=0}),{next:()=>_(this,null,function*(){return e.length?{value:e.shift(),done:!1}:n?{value:void 0,done:!0}:new Promise((a,i)=>t.push({resolve:a,reject:i})).then(a=>a?{value:a,done:!1}:{value:void 0,done:!0})}),return:()=>_(this,null,function*(){return this.abort(),{value:void 0,done:!0}})}}toReadableStream(){return new fe(this[Symbol.asyncIterator].bind(this),this.controller).toReadableStream()}}function fi(s,e){const d=s,{id:t,choices:n,created:r,model:a,system_fingerprint:i}=d,l=F(d,["id","choices","created","model","system_fingerprint"]),p=o(u(o({},l),{id:t,choices:n.map(C=>{var P=C,{message:w,finish_reason:f,index:m,logprobs:h}=P,y=F(P,["message","finish_reason","index","logprobs"]);var U,L,M;if(!f)throw new R(`missing finish_reason for choice ${m}`);const H=w,{content:v=null,function_call:k,tool_calls:D}=H,O=F(H,["content","function_call","tool_calls"]),T=w.role;if(!T)throw new R(`missing role for choice ${m}`);if(k){const{arguments:$,name:N}=k;if($==null)throw new R(`missing function_call.arguments for choice ${m}`);if(!N)throw new R(`missing function_call.name for choice ${m}`);return u(o({},y),{message:{content:v,function_call:{arguments:$,name:N},role:T,refusal:(U=w.refusal)!=null?U:null},finish_reason:f,index:m,logprobs:h})}return D?u(o({},y),{index:m,finish_reason:f,logprobs:h,message:u(o({},O),{role:T,content:v,refusal:(L=w.refusal)!=null?L:null,tool_calls:D.map(($,N)=>{const _e=$,{function:x,type:te,id:Ae}=_e,oe=F(_e,["function","type","id"]),we=x||{},{arguments:Be,name:He}=we,Gt=F(we,["arguments","name"]);if(Ae==null)throw new R(`missing choices[${m}].tool_calls[${N}].id
${yt(s)}`);if(te==null)throw new R(`missing choices[${m}].tool_calls[${N}].type
${yt(s)}`);if(He==null)throw new R(`missing choices[${m}].tool_calls[${N}].function.name
${yt(s)}`);if(Be==null)throw new R(`missing choices[${m}].tool_calls[${N}].function.arguments
${yt(s)}`);return u(o({},oe),{id:Ae,type:te,function:u(o({},Gt),{name:He,arguments:Be})})})})}):u(o({},y),{message:u(o({},O),{content:v,role:T,refusal:(M=w.refusal)!=null?M:null}),finish_reason:f,index:m,logprobs:h})}),created:r,model:a,object:"chat.completion"}),i?{system_fingerprint:i}:{});return ti(p,e)}function yt(s){return JSON.stringify(s)}class Ft extends De{static fromReadableStream(e){const t=new Ft(null);return t._run(()=>t._fromReadableStream(e)),t}static runTools(e,t,n){const r=new Ft(t),a=u(o({},n),{headers:u(o({},n==null?void 0:n.headers),{"X-Stainless-Helper-Method":"runTools"})});return r._run(()=>r._runTools(e,t,a)),r}}let $n=class extends S{constructor(){super(...arguments),this.messages=new Gs(this._client)}create(e,t){var n;return this._client.post("/chat/completions",u(o({body:e},t),{stream:(n=e.stream)!=null?n:!1}))}retrieve(e,t){return this._client.get(g`/chat/completions/${e}`,t)}update(e,t,n){return this._client.post(g`/chat/completions/${e}`,o({body:t},n))}list(e={},t){return this._client.getAPIList("/chat/completions",j,o({query:e},t))}delete(e,t){return this._client.delete(g`/chat/completions/${e}`,t)}parse(e,t){return ai(e.tools),this._client.chat.completions.create(e,u(o({},t),{headers:u(o({},t==null?void 0:t.headers),{"X-Stainless-Helper-Method":"chat.completions.parse"})}))._thenUnwrap(n=>In(n,e))}runTools(e,t){return e.stream?Ft.runTools(this._client,e,t):Pn.runTools(this._client,e,t)}stream(e,t){return De.createChatCompletion(this._client,e,t)}};$n.Messages=Gs;class Mn extends S{constructor(){super(...arguments),this.completions=new $n(this._client)}}Mn.Completions=$n;const wr=Symbol("brand.privateNullableHeaders");function*mi(s){if(!s)return;if(wr in s){const{values:n,nulls:r}=s;yield*Qn(n.entries());for(const a of r)yield[a,null];return}let e=!1,t;s instanceof Headers?t=s.entries():Zn(s)?t=s:(e=!0,t=Object.entries(s!=null?s:{}));for(let n of t){const r=n[0];if(typeof r!="string")throw new TypeError("expected header name to be a string");const a=Zn(n[1])?n[1]:[n[1]];let i=!1;for(const l of a)l!==void 0&&(e&&!i&&(i=!0,yield[r,null]),yield[r,l])}}const b=s=>{const e=new Headers,t=new Set;for(const n of s){const r=new Set;for(const[a,i]of mi(n)){const l=a.toLowerCase();r.has(l)||(e.delete(a),r.add(l)),i===null?(e.delete(a),t.add(l)):(e.append(a,i),t.delete(l))}}return{[wr]:!0,values:e,nulls:t}};class yr extends S{create(e,t){return this._client.post("/audio/speech",u(o({body:e},t),{headers:b([{Accept:"application/octet-stream"},t==null?void 0:t.headers]),__binaryResponse:!0}))}}class br extends S{create(e,t){var n;return this._client.post("/audio/transcriptions",Ce(u(o({body:e},t),{stream:(n=e.stream)!=null?n:!1,__metadata:{model:e.model}}),this._client))}}class vr extends S{create(e,t){return this._client.post("/audio/translations",Ce(u(o({body:e},t),{__metadata:{model:e.model}}),this._client))}}class it extends S{constructor(){super(...arguments),this.transcriptions=new br(this._client),this.translations=new vr(this._client),this.speech=new yr(this._client)}}it.Transcriptions=br;it.Translations=vr;it.Speech=yr;class Ar extends S{create(e,t){return this._client.post("/batches",o({body:e},t))}retrieve(e,t){return this._client.get(g`/batches/${e}`,t)}list(e={},t){return this._client.getAPIList("/batches",j,o({query:e},t))}cancel(e,t){return this._client.post(g`/batches/${e}/cancel`,t)}}class Sr extends S{create(e,t){return this._client.post("/assistants",u(o({body:e},t),{headers:b([{"OpenAI-Beta":"assistants=v2"},t==null?void 0:t.headers])}))}retrieve(e,t){return this._client.get(g`/assistants/${e}`,u(o({},t),{headers:b([{"OpenAI-Beta":"assistants=v2"},t==null?void 0:t.headers])}))}update(e,t,n){return this._client.post(g`/assistants/${e}`,u(o({body:t},n),{headers:b([{"OpenAI-Beta":"assistants=v2"},n==null?void 0:n.headers])}))}list(e={},t){return this._client.getAPIList("/assistants",j,u(o({query:e},t),{headers:b([{"OpenAI-Beta":"assistants=v2"},t==null?void 0:t.headers])}))}delete(e,t){return this._client.delete(g`/assistants/${e}`,u(o({},t),{headers:b([{"OpenAI-Beta":"assistants=v2"},t==null?void 0:t.headers])}))}}let Rr=class extends S{create(e,t){return this._client.post("/realtime/sessions",u(o({body:e},t),{headers:b([{"OpenAI-Beta":"assistants=v2"},t==null?void 0:t.headers])}))}};class xr extends S{create(e,t){return this._client.post("/realtime/transcription_sessions",u(o({body:e},t),{headers:b([{"OpenAI-Beta":"assistants=v2"},t==null?void 0:t.headers])}))}}let qt=class extends S{constructor(){super(...arguments),this.sessions=new Rr(this._client),this.transcriptionSessions=new xr(this._client)}};qt.Sessions=Rr;qt.TranscriptionSessions=xr;class kr extends S{create(e,t){return this._client.post("/chatkit/sessions",u(o({body:e},t),{headers:b([{"OpenAI-Beta":"chatkit_beta=v1"},t==null?void 0:t.headers])}))}cancel(e,t){return this._client.post(g`/chatkit/sessions/${e}/cancel`,u(o({},t),{headers:b([{"OpenAI-Beta":"chatkit_beta=v1"},t==null?void 0:t.headers])}))}}let Cr=class extends S{retrieve(e,t){return this._client.get(g`/chatkit/threads/${e}`,u(o({},t),{headers:b([{"OpenAI-Beta":"chatkit_beta=v1"},t==null?void 0:t.headers])}))}list(e={},t){return this._client.getAPIList("/chatkit/threads",Mt,u(o({query:e},t),{headers:b([{"OpenAI-Beta":"chatkit_beta=v1"},t==null?void 0:t.headers])}))}delete(e,t){return this._client.delete(g`/chatkit/threads/${e}`,u(o({},t),{headers:b([{"OpenAI-Beta":"chatkit_beta=v1"},t==null?void 0:t.headers])}))}listItems(e,t={},n){return this._client.getAPIList(g`/chatkit/threads/${e}/items`,Mt,u(o({query:t},n),{headers:b([{"OpenAI-Beta":"chatkit_beta=v1"},n==null?void 0:n.headers])}))}};class Vt extends S{constructor(){super(...arguments),this.sessions=new kr(this._client),this.threads=new Cr(this._client)}}Vt.Sessions=kr;Vt.Threads=Cr;class Ir extends S{create(e,t,n){return this._client.post(g`/threads/${e}/messages`,u(o({body:t},n),{headers:b([{"OpenAI-Beta":"assistants=v2"},n==null?void 0:n.headers])}))}retrieve(e,t,n){const{thread_id:r}=t;return this._client.get(g`/threads/${r}/messages/${e}`,u(o({},n),{headers:b([{"OpenAI-Beta":"assistants=v2"},n==null?void 0:n.headers])}))}update(e,t,n){const i=t,{thread_id:r}=i,a=F(i,["thread_id"]);return this._client.post(g`/threads/${r}/messages/${e}`,u(o({body:a},n),{headers:b([{"OpenAI-Beta":"assistants=v2"},n==null?void 0:n.headers])}))}list(e,t={},n){return this._client.getAPIList(g`/threads/${e}/messages`,j,u(o({query:t},n),{headers:b([{"OpenAI-Beta":"assistants=v2"},n==null?void 0:n.headers])}))}delete(e,t,n){const{thread_id:r}=t;return this._client.delete(g`/threads/${r}/messages/${e}`,u(o({},n),{headers:b([{"OpenAI-Beta":"assistants=v2"},n==null?void 0:n.headers])}))}}class Er extends S{retrieve(e,t,n){const l=t,{thread_id:r,run_id:a}=l,i=F(l,["thread_id","run_id"]);return this._client.get(g`/threads/${r}/runs/${a}/steps/${e}`,u(o({query:i},n),{headers:b([{"OpenAI-Beta":"assistants=v2"},n==null?void 0:n.headers])}))}list(e,t,n){const i=t,{thread_id:r}=i,a=F(i,["thread_id"]);return this._client.getAPIList(g`/threads/${r}/runs/${e}/steps`,j,u(o({query:a},n),{headers:b([{"OpenAI-Beta":"assistants=v2"},n==null?void 0:n.headers])}))}}const pi=s=>{if(typeof Buffer!="undefined"){const e=Buffer.from(s,"base64");return Array.from(new Float32Array(e.buffer,e.byteOffset,e.length/Float32Array.BYTES_PER_ELEMENT))}else{const e=atob(s),t=e.length,n=new Uint8Array(t);for(let r=0;r<t;r++)n[r]=e.charCodeAt(r);return Array.from(new Float32Array(n.buffer))}};var on={};const Pe=s=>{var e,t,n,r,a;if(typeof globalThis.process!="undefined")return(t=(e=on==null?void 0:on[s])==null?void 0:e.trim())!=null?t:void 0;if(typeof globalThis.Deno!="undefined")return(a=(r=(n=globalThis.Deno.env)==null?void 0:n.get)==null?void 0:r.call(n,s))==null?void 0:a.trim()};var z,xe,yn,he,kt,le,ke,Ne,Re,Wt,ae,Ct,It,nt,Ye,Ze,hs,fs,ms,ps,gs,_s,ws;class st extends En{constructor(){super(...arguments),z.add(this),yn.set(this,[]),he.set(this,{}),kt.set(this,{}),le.set(this,void 0),ke.set(this,void 0),Ne.set(this,void 0),Re.set(this,void 0),Wt.set(this,void 0),ae.set(this,void 0),Ct.set(this,void 0),It.set(this,void 0),nt.set(this,void 0)}[(yn=new WeakMap,he=new WeakMap,kt=new WeakMap,le=new WeakMap,ke=new WeakMap,Ne=new WeakMap,Re=new WeakMap,Wt=new WeakMap,ae=new WeakMap,Ct=new WeakMap,It=new WeakMap,nt=new WeakMap,z=new WeakSet,Symbol.asyncIterator)](){const e=[],t=[];let n=!1;return this.on("event",r=>{const a=t.shift();a?a.resolve(r):e.push(r)}),this.on("end",()=>{n=!0;for(const r of t)r.resolve(void 0);t.length=0}),this.on("abort",r=>{n=!0;for(const a of t)a.reject(r);t.length=0}),this.on("error",r=>{n=!0;for(const a of t)a.reject(r);t.length=0}),{next:()=>_(this,null,function*(){return e.length?{value:e.shift(),done:!1}:n?{value:void 0,done:!0}:new Promise((a,i)=>t.push({resolve:a,reject:i})).then(a=>a?{value:a,done:!1}:{value:void 0,done:!0})}),return:()=>_(this,null,function*(){return this.abort(),{value:void 0,done:!0}})}}static fromReadableStream(e){const t=new xe;return t._run(()=>t._fromReadableStream(e)),t}_fromReadableStream(e,t){return _(this,null,function*(){var d;const n=t==null?void 0:t.signal;n&&(n.aborted&&this.controller.abort(),n.addEventListener("abort",()=>this.controller.abort())),this._connected();const r=fe.fromReadableStream(e,this.controller);try{for(var a=G(r),i,l,p;i=!(l=yield a.next()).done;i=!1){const w=l.value;c(this,z,"m",Ye).call(this,w)}}catch(l){p=[l]}finally{try{i&&(l=a.return)&&(yield l.call(a))}finally{if(p)throw p[0]}}if((d=r.controller.signal)!=null&&d.aborted)throw new ie;return this._addRun(c(this,z,"m",Ze).call(this))})}toReadableStream(){return new fe(this[Symbol.asyncIterator].bind(this),this.controller).toReadableStream()}static createToolAssistantStream(e,t,n,r){const a=new xe;return a._run(()=>a._runToolAssistantStream(e,t,n,u(o({},r),{headers:u(o({},r==null?void 0:r.headers),{"X-Stainless-Helper-Method":"stream"})}))),a}_createToolAssistantStream(e,t,n,r){return _(this,null,function*(){var m;const a=r==null?void 0:r.signal;a&&(a.aborted&&this.controller.abort(),a.addEventListener("abort",()=>this.controller.abort()));const i=u(o({},n),{stream:!0}),l=yield e.submitToolOutputs(t,i,u(o({},r),{signal:this.controller.signal}));this._connected();try{for(var p=G(l),d,w,f;d=!(w=yield p.next()).done;d=!1){const h=w.value;c(this,z,"m",Ye).call(this,h)}}catch(w){f=[w]}finally{try{d&&(w=p.return)&&(yield w.call(p))}finally{if(f)throw f[0]}}if((m=l.controller.signal)!=null&&m.aborted)throw new ie;return this._addRun(c(this,z,"m",Ze).call(this))})}static createThreadAssistantStream(e,t,n){const r=new xe;return r._run(()=>r._threadAssistantStream(e,t,u(o({},n),{headers:u(o({},n==null?void 0:n.headers),{"X-Stainless-Helper-Method":"stream"})}))),r}static createAssistantStream(e,t,n,r){const a=new xe;return a._run(()=>a._runAssistantStream(e,t,n,u(o({},r),{headers:u(o({},r==null?void 0:r.headers),{"X-Stainless-Helper-Method":"stream"})}))),a}currentEvent(){return c(this,Ct,"f")}currentRun(){return c(this,It,"f")}currentMessageSnapshot(){return c(this,le,"f")}currentRunStepSnapshot(){return c(this,nt,"f")}finalRunSteps(){return _(this,null,function*(){return yield this.done(),Object.values(c(this,he,"f"))})}finalMessages(){return _(this,null,function*(){return yield this.done(),Object.values(c(this,kt,"f"))})}finalRun(){return _(this,null,function*(){if(yield this.done(),!c(this,ke,"f"))throw Error("Final run was not received.");return c(this,ke,"f")})}_createThreadAssistantStream(e,t,n){return _(this,null,function*(){var f;const r=n==null?void 0:n.signal;r&&(r.aborted&&this.controller.abort(),r.addEventListener("abort",()=>this.controller.abort()));const a=u(o({},t),{stream:!0}),i=yield e.createAndRun(a,u(o({},n),{signal:this.controller.signal}));this._connected();try{for(var l=G(i),p,d,w;p=!(d=yield l.next()).done;p=!1){const m=d.value;c(this,z,"m",Ye).call(this,m)}}catch(d){w=[d]}finally{try{p&&(d=l.return)&&(yield d.call(l))}finally{if(w)throw w[0]}}if((f=i.controller.signal)!=null&&f.aborted)throw new ie;return this._addRun(c(this,z,"m",Ze).call(this))})}_createAssistantStream(e,t,n,r){return _(this,null,function*(){var m;const a=r==null?void 0:r.signal;a&&(a.aborted&&this.controller.abort(),a.addEventListener("abort",()=>this.controller.abort()));const i=u(o({},n),{stream:!0}),l=yield e.create(t,i,u(o({},r),{signal:this.controller.signal}));this._connected();try{for(var p=G(l),d,w,f;d=!(w=yield p.next()).done;d=!1){const h=w.value;c(this,z,"m",Ye).call(this,h)}}catch(w){f=[w]}finally{try{d&&(w=p.return)&&(yield w.call(p))}finally{if(f)throw f[0]}}if((m=l.controller.signal)!=null&&m.aborted)throw new ie;return this._addRun(c(this,z,"m",Ze).call(this))})}static accumulateDelta(e,t){for(const[n,r]of Object.entries(t)){if(!e.hasOwnProperty(n)){e[n]=r;continue}let a=e[n];if(a==null){e[n]=r;continue}if(n==="index"||n==="type"){e[n]=r;continue}if(typeof a=="string"&&typeof r=="string")a+=r;else if(typeof a=="number"&&typeof r=="number")a+=r;else if(Yt(a)&&Yt(r))a=this.accumulateDelta(a,r);else if(Array.isArray(a)&&Array.isArray(r)){if(a.every(i=>typeof i=="string"||typeof i=="number")){a.push(...r);continue}for(const i of r){if(!Yt(i))throw new Error(`Expected array delta entry to be an object but got: ${i}`);const l=i.index;if(l==null)throw console.error(i),new Error("Expected array delta entry to have an `index` property");if(typeof l!="number")throw new Error(`Expected array delta entry \`index\` property to be a number but got ${l}`);const p=a[l];p==null?a.push(i):a[l]=this.accumulateDelta(p,i)}continue}else throw Error(`Unhandled record type: ${n}, deltaValue: ${r}, accValue: ${a}`);e[n]=a}return e}_addRun(e){return e}_threadAssistantStream(e,t,n){return _(this,null,function*(){return yield this._createThreadAssistantStream(t,e,n)})}_runAssistantStream(e,t,n,r){return _(this,null,function*(){return yield this._createAssistantStream(t,e,n,r)})}_runToolAssistantStream(e,t,n,r){return _(this,null,function*(){return yield this._createToolAssistantStream(t,e,n,r)})}}xe=st,Ye=function(e){if(!this.ended)switch(I(this,Ct,e),c(this,z,"m",ms).call(this,e),e.event){case"thread.created":break;case"thread.run.created":case"thread.run.queued":case"thread.run.in_progress":case"thread.run.requires_action":case"thread.run.completed":case"thread.run.incomplete":case"thread.run.failed":case"thread.run.cancelling":case"thread.run.cancelled":case"thread.run.expired":c(this,z,"m",ws).call(this,e);break;case"thread.run.step.created":case"thread.run.step.in_progress":case"thread.run.step.delta":case"thread.run.step.completed":case"thread.run.step.failed":case"thread.run.step.cancelled":case"thread.run.step.expired":c(this,z,"m",fs).call(this,e);break;case"thread.message.created":case"thread.message.in_progress":case"thread.message.delta":case"thread.message.completed":case"thread.message.incomplete":c(this,z,"m",hs).call(this,e);break;case"error":throw new Error("Encountered an error event in event processing - errors should be processed earlier")}},Ze=function(){if(this.ended)throw new R("stream has ended, this shouldn't happen");if(!c(this,ke,"f"))throw Error("Final run has not been received");return c(this,ke,"f")},hs=function(e){const[t,n]=c(this,z,"m",gs).call(this,e,c(this,le,"f"));I(this,le,t),c(this,kt,"f")[t.id]=t;for(const r of n){const a=t.content[r.index];(a==null?void 0:a.type)=="text"&&this._emit("textCreated",a.text)}switch(e.event){case"thread.message.created":this._emit("messageCreated",e.data);break;case"thread.message.in_progress":break;case"thread.message.delta":if(this._emit("messageDelta",e.data.delta,t),e.data.delta.content)for(const r of e.data.delta.content){if(r.type=="text"&&r.text){let a=r.text,i=t.content[r.index];if(i&&i.type=="text")this._emit("textDelta",a,i.text);else throw Error("The snapshot associated with this text delta is not text or missing")}if(r.index!=c(this,Ne,"f")){if(c(this,Re,"f"))switch(c(this,Re,"f").type){case"text":this._emit("textDone",c(this,Re,"f").text,c(this,le,"f"));break;case"image_file":this._emit("imageFileDone",c(this,Re,"f").image_file,c(this,le,"f"));break}I(this,Ne,r.index)}I(this,Re,t.content[r.index])}break;case"thread.message.completed":case"thread.message.incomplete":if(c(this,Ne,"f")!==void 0){const r=e.data.content[c(this,Ne,"f")];if(r)switch(r.type){case"image_file":this._emit("imageFileDone",r.image_file,c(this,le,"f"));break;case"text":this._emit("textDone",r.text,c(this,le,"f"));break}}c(this,le,"f")&&this._emit("messageDone",e.data),I(this,le,void 0)}},fs=function(e){const t=c(this,z,"m",ps).call(this,e);switch(I(this,nt,t),e.event){case"thread.run.step.created":this._emit("runStepCreated",e.data);break;case"thread.run.step.delta":const n=e.data.delta;if(n.step_details&&n.step_details.type=="tool_calls"&&n.step_details.tool_calls&&t.step_details.type=="tool_calls")for(const a of n.step_details.tool_calls)a.index==c(this,Wt,"f")?this._emit("toolCallDelta",a,t.step_details.tool_calls[a.index]):(c(this,ae,"f")&&this._emit("toolCallDone",c(this,ae,"f")),I(this,Wt,a.index),I(this,ae,t.step_details.tool_calls[a.index]),c(this,ae,"f")&&this._emit("toolCallCreated",c(this,ae,"f")));this._emit("runStepDelta",e.data.delta,t);break;case"thread.run.step.completed":case"thread.run.step.failed":case"thread.run.step.cancelled":case"thread.run.step.expired":I(this,nt,void 0),e.data.step_details.type=="tool_calls"&&c(this,ae,"f")&&(this._emit("toolCallDone",c(this,ae,"f")),I(this,ae,void 0)),this._emit("runStepDone",e.data,t);break}},ms=function(e){c(this,yn,"f").push(e),this._emit("event",e)},ps=function(e){switch(e.event){case"thread.run.step.created":return c(this,he,"f")[e.data.id]=e.data,e.data;case"thread.run.step.delta":let t=c(this,he,"f")[e.data.id];if(!t)throw Error("Received a RunStepDelta before creation of a snapshot");let n=e.data;if(n.delta){const r=xe.accumulateDelta(t,n.delta);c(this,he,"f")[e.data.id]=r}return c(this,he,"f")[e.data.id];case"thread.run.step.completed":case"thread.run.step.failed":case"thread.run.step.cancelled":case"thread.run.step.expired":case"thread.run.step.in_progress":c(this,he,"f")[e.data.id]=e.data;break}if(c(this,he,"f")[e.data.id])return c(this,he,"f")[e.data.id];throw new Error("No snapshot available")},gs=function(e,t){let n=[];switch(e.event){case"thread.message.created":return[e.data,n];case"thread.message.delta":if(!t)throw Error("Received a delta with no existing snapshot (there should be one from message creation)");let r=e.data;if(r.delta.content)for(const a of r.delta.content)if(a.index in t.content){let i=t.content[a.index];t.content[a.index]=c(this,z,"m",_s).call(this,a,i)}else t.content[a.index]=a,n.push(a);return[t,n];case"thread.message.in_progress":case"thread.message.completed":case"thread.message.incomplete":if(t)return[t,n];throw Error("Received thread message event with no existing snapshot")}throw Error("Tried to accumulate a non-message event")},_s=function(e,t){return xe.accumulateDelta(t,e)},ws=function(e){switch(I(this,It,e.data),e.event){case"thread.run.created":break;case"thread.run.queued":break;case"thread.run.in_progress":break;case"thread.run.requires_action":case"thread.run.cancelled":case"thread.run.failed":case"thread.run.completed":case"thread.run.expired":case"thread.run.incomplete":I(this,ke,e.data),c(this,ae,"f")&&(this._emit("toolCallDone",c(this,ae,"f")),I(this,ae,void 0));break}};let On=class extends S{constructor(){super(...arguments),this.steps=new Er(this._client)}create(e,t,n){var l;const i=t,{include:r}=i,a=F(i,["include"]);return this._client.post(g`/threads/${e}/runs`,u(o({query:{include:r},body:a},n),{headers:b([{"OpenAI-Beta":"assistants=v2"},n==null?void 0:n.headers]),stream:(l=t.stream)!=null?l:!1}))}retrieve(e,t,n){const{thread_id:r}=t;return this._client.get(g`/threads/${r}/runs/${e}`,u(o({},n),{headers:b([{"OpenAI-Beta":"assistants=v2"},n==null?void 0:n.headers])}))}update(e,t,n){const i=t,{thread_id:r}=i,a=F(i,["thread_id"]);return this._client.post(g`/threads/${r}/runs/${e}`,u(o({body:a},n),{headers:b([{"OpenAI-Beta":"assistants=v2"},n==null?void 0:n.headers])}))}list(e,t={},n){return this._client.getAPIList(g`/threads/${e}/runs`,j,u(o({query:t},n),{headers:b([{"OpenAI-Beta":"assistants=v2"},n==null?void 0:n.headers])}))}cancel(e,t,n){const{thread_id:r}=t;return this._client.post(g`/threads/${r}/runs/${e}/cancel`,u(o({},n),{headers:b([{"OpenAI-Beta":"assistants=v2"},n==null?void 0:n.headers])}))}createAndPoll(e,t,n){return _(this,null,function*(){const r=yield this.create(e,t,n);return yield this.poll(r.id,{thread_id:e},n)})}createAndStream(e,t,n){return st.createAssistantStream(e,this._client.beta.threads.runs,t,n)}poll(e,t,n){return _(this,null,function*(){var a,i;const r=b([n==null?void 0:n.headers,{"X-Stainless-Poll-Helper":"true","X-Stainless-Custom-Poll-Interval":(i=(a=n==null?void 0:n.pollIntervalMs)==null?void 0:a.toString())!=null?i:void 0}]);for(;;){const{data:l,response:p}=yield this.retrieve(e,t,u(o({},n),{headers:o(o({},n==null?void 0:n.headers),r)})).withResponse();switch(l.status){case"queued":case"in_progress":case"cancelling":let d=5e3;if(n!=null&&n.pollIntervalMs)d=n.pollIntervalMs;else{const w=p.headers.get("openai-poll-after-ms");if(w){const f=parseInt(w);isNaN(f)||(d=f)}}yield rt(d);break;case"requires_action":case"incomplete":case"cancelled":case"completed":case"failed":case"expired":return l}}})}stream(e,t,n){return st.createAssistantStream(e,this._client.beta.threads.runs,t,n)}submitToolOutputs(e,t,n){var l;const i=t,{thread_id:r}=i,a=F(i,["thread_id"]);return this._client.post(g`/threads/${r}/runs/${e}/submit_tool_outputs`,u(o({body:a},n),{headers:b([{"OpenAI-Beta":"assistants=v2"},n==null?void 0:n.headers]),stream:(l=t.stream)!=null?l:!1}))}submitToolOutputsAndPoll(e,t,n){return _(this,null,function*(){const r=yield this.submitToolOutputs(e,t,n);return yield this.poll(r.id,t,n)})}submitToolOutputsStream(e,t,n){return st.createToolAssistantStream(e,this._client.beta.threads.runs,t,n)}};On.Steps=Er;class Jt extends S{constructor(){super(...arguments),this.runs=new On(this._client),this.messages=new Ir(this._client)}create(e={},t){return this._client.post("/threads",u(o({body:e},t),{headers:b([{"OpenAI-Beta":"assistants=v2"},t==null?void 0:t.headers])}))}retrieve(e,t){return this._client.get(g`/threads/${e}`,u(o({},t),{headers:b([{"OpenAI-Beta":"assistants=v2"},t==null?void 0:t.headers])}))}update(e,t,n){return this._client.post(g`/threads/${e}`,u(o({body:t},n),{headers:b([{"OpenAI-Beta":"assistants=v2"},n==null?void 0:n.headers])}))}delete(e,t){return this._client.delete(g`/threads/${e}`,u(o({},t),{headers:b([{"OpenAI-Beta":"assistants=v2"},t==null?void 0:t.headers])}))}createAndRun(e,t){var n;return this._client.post("/threads/runs",u(o({body:e},t),{headers:b([{"OpenAI-Beta":"assistants=v2"},t==null?void 0:t.headers]),stream:(n=e.stream)!=null?n:!1}))}createAndRunPoll(e,t){return _(this,null,function*(){const n=yield this.createAndRun(e,t);return yield this.runs.poll(n.id,{thread_id:n.thread_id},t)})}createAndRunStream(e,t){return st.createThreadAssistantStream(e,this._client.beta.threads,t)}}Jt.Runs=On;Jt.Messages=Ir;class Fe extends S{constructor(){super(...arguments),this.realtime=new qt(this._client),this.chatkit=new Vt(this._client),this.assistants=new Sr(this._client),this.threads=new Jt(this._client)}}Fe.Realtime=qt;Fe.ChatKit=Vt;Fe.Assistants=Sr;Fe.Threads=Jt;class Pr extends S{create(e,t){var n;return this._client.post("/completions",u(o({body:e},t),{stream:(n=e.stream)!=null?n:!1}))}}class $r extends S{retrieve(e,t,n){const{container_id:r}=t;return this._client.get(g`/containers/${r}/files/${e}/content`,u(o({},n),{headers:b([{Accept:"application/binary"},n==null?void 0:n.headers]),__binaryResponse:!0}))}}let Tn=class extends S{constructor(){super(...arguments),this.content=new $r(this._client)}create(e,t,n){return this._client.post(g`/containers/${e}/files`,Ce(o({body:t},n),this._client))}retrieve(e,t,n){const{container_id:r}=t;return this._client.get(g`/containers/${r}/files/${e}`,n)}list(e,t={},n){return this._client.getAPIList(g`/containers/${e}/files`,j,o({query:t},n))}delete(e,t,n){const{container_id:r}=t;return this._client.delete(g`/containers/${r}/files/${e}`,u(o({},n),{headers:b([{Accept:"*/*"},n==null?void 0:n.headers])}))}};Tn.Content=$r;class Ln extends S{constructor(){super(...arguments),this.files=new Tn(this._client)}create(e,t){return this._client.post("/containers",o({body:e},t))}retrieve(e,t){return this._client.get(g`/containers/${e}`,t)}list(e={},t){return this._client.getAPIList("/containers",j,o({query:e},t))}delete(e,t){return this._client.delete(g`/containers/${e}`,u(o({},t),{headers:b([{Accept:"*/*"},t==null?void 0:t.headers])}))}}Ln.Files=Tn;class Mr extends S{create(e,t,n){const i=t,{include:r}=i,a=F(i,["include"]);return this._client.post(g`/conversations/${e}/items`,o({query:{include:r},body:a},n))}retrieve(e,t,n){const i=t,{conversation_id:r}=i,a=F(i,["conversation_id"]);return this._client.get(g`/conversations/${r}/items/${e}`,o({query:a},n))}list(e,t={},n){return this._client.getAPIList(g`/conversations/${e}/items`,Mt,o({query:t},n))}delete(e,t,n){const{conversation_id:r}=t;return this._client.delete(g`/conversations/${r}/items/${e}`,n)}}class Nn extends S{constructor(){super(...arguments),this.items=new Mr(this._client)}create(e={},t){return this._client.post("/conversations",o({body:e},t))}retrieve(e,t){return this._client.get(g`/conversations/${e}`,t)}update(e,t,n){return this._client.post(g`/conversations/${e}`,o({body:t},n))}delete(e,t){return this._client.delete(g`/conversations/${e}`,t)}}Nn.Items=Mr;class Or extends S{create(e,t){const n=!!e.encoding_format;let r=n?e.encoding_format:"base64";n&&K(this._client).debug("embeddings/user defined encoding_format:",e.encoding_format);const a=this._client.post("/embeddings",o({body:u(o({},e),{encoding_format:r})},t));return n?a:(K(this._client).debug("embeddings/decoding base64 embeddings from base64"),a._thenUnwrap(i=>(i&&i.data&&i.data.forEach(l=>{const p=l.embedding;l.embedding=pi(p)}),i)))}}class Tr extends S{retrieve(e,t,n){const{eval_id:r,run_id:a}=t;return this._client.get(g`/evals/${r}/runs/${a}/output_items/${e}`,n)}list(e,t,n){const i=t,{eval_id:r}=i,a=F(i,["eval_id"]);return this._client.getAPIList(g`/evals/${r}/runs/${e}/output_items`,j,o({query:a},n))}}class Dn extends S{constructor(){super(...arguments),this.outputItems=new Tr(this._client)}create(e,t,n){return this._client.post(g`/evals/${e}/runs`,o({body:t},n))}retrieve(e,t,n){const{eval_id:r}=t;return this._client.get(g`/evals/${r}/runs/${e}`,n)}list(e,t={},n){return this._client.getAPIList(g`/evals/${e}/runs`,j,o({query:t},n))}delete(e,t,n){const{eval_id:r}=t;return this._client.delete(g`/evals/${r}/runs/${e}`,n)}cancel(e,t,n){const{eval_id:r}=t;return this._client.post(g`/evals/${r}/runs/${e}`,n)}}Dn.OutputItems=Tr;class Fn extends S{constructor(){super(...arguments),this.runs=new Dn(this._client)}create(e,t){return this._client.post("/evals",o({body:e},t))}retrieve(e,t){return this._client.get(g`/evals/${e}`,t)}update(e,t,n){return this._client.post(g`/evals/${e}`,o({body:t},n))}list(e={},t){return this._client.getAPIList("/evals",j,o({query:e},t))}delete(e,t){return this._client.delete(g`/evals/${e}`,t)}}Fn.Runs=Dn;let Lr=class extends S{create(e,t){return this._client.post("/files",Ce(o({body:e},t),this._client))}retrieve(e,t){return this._client.get(g`/files/${e}`,t)}list(e={},t){return this._client.getAPIList("/files",j,o({query:e},t))}delete(e,t){return this._client.delete(g`/files/${e}`,t)}content(e,t){return this._client.get(g`/files/${e}/content`,u(o({},t),{headers:b([{Accept:"application/binary"},t==null?void 0:t.headers]),__binaryResponse:!0}))}waitForProcessing(r){return _(this,arguments,function*(e,{pollInterval:t=5e3,maxWait:n=30*60*1e3}={}){const a=new Set(["processed","error","deleted"]),i=Date.now();let l=yield this.retrieve(e);for(;!l.status||!a.has(l.status);)if(yield rt(t),l=yield this.retrieve(e),Date.now()-i>n)throw new Sn({message:`Giving up on waiting for file ${e} to finish processing after ${n} milliseconds.`});return l})}};class Nr extends S{}let Dr=class extends S{run(e,t){return this._client.post("/fine_tuning/alpha/graders/run",o({body:e},t))}validate(e,t){return this._client.post("/fine_tuning/alpha/graders/validate",o({body:e},t))}};class Wn extends S{constructor(){super(...arguments),this.graders=new Dr(this._client)}}Wn.Graders=Dr;class Fr extends S{create(e,t,n){return this._client.getAPIList(g`/fine_tuning/checkpoints/${e}/permissions`,jt,o({body:t,method:"post"},n))}retrieve(e,t={},n){return this._client.get(g`/fine_tuning/checkpoints/${e}/permissions`,o({query:t},n))}delete(e,t,n){const{fine_tuned_model_checkpoint:r}=t;return this._client.delete(g`/fine_tuning/checkpoints/${r}/permissions/${e}`,n)}}let Bn=class extends S{constructor(){super(...arguments),this.permissions=new Fr(this._client)}};Bn.Permissions=Fr;class Wr extends S{list(e,t={},n){return this._client.getAPIList(g`/fine_tuning/jobs/${e}/checkpoints`,j,o({query:t},n))}}class Hn extends S{constructor(){super(...arguments),this.checkpoints=new Wr(this._client)}create(e,t){return this._client.post("/fine_tuning/jobs",o({body:e},t))}retrieve(e,t){return this._client.get(g`/fine_tuning/jobs/${e}`,t)}list(e={},t){return this._client.getAPIList("/fine_tuning/jobs",j,o({query:e},t))}cancel(e,t){return this._client.post(g`/fine_tuning/jobs/${e}/cancel`,t)}listEvents(e,t={},n){return this._client.getAPIList(g`/fine_tuning/jobs/${e}/events`,j,o({query:t},n))}pause(e,t){return this._client.post(g`/fine_tuning/jobs/${e}/pause`,t)}resume(e,t){return this._client.post(g`/fine_tuning/jobs/${e}/resume`,t)}}Hn.Checkpoints=Wr;class We extends S{constructor(){super(...arguments),this.methods=new Nr(this._client),this.jobs=new Hn(this._client),this.checkpoints=new Bn(this._client),this.alpha=new Wn(this._client)}}We.Methods=Nr;We.Jobs=Hn;We.Checkpoints=Bn;We.Alpha=Wn;class Br extends S{}class Un extends S{constructor(){super(...arguments),this.graderModels=new Br(this._client)}}Un.GraderModels=Br;class Hr extends S{createVariation(e,t){return this._client.post("/images/variations",Ce(o({body:e},t),this._client))}edit(e,t){var n;return this._client.post("/images/edits",Ce(u(o({body:e},t),{stream:(n=e.stream)!=null?n:!1}),this._client))}generate(e,t){var n;return this._client.post("/images/generations",u(o({body:e},t),{stream:(n=e.stream)!=null?n:!1}))}}class Ur extends S{retrieve(e,t){return this._client.get(g`/models/${e}`,t)}list(e){return this._client.getAPIList("/models",jt,e)}delete(e,t){return this._client.delete(g`/models/${e}`,t)}}class jr extends S{create(e,t){return this._client.post("/moderations",o({body:e},t))}}class qr extends S{accept(e,t,n){return this._client.post(g`/realtime/calls/${e}/accept`,u(o({body:t},n),{headers:b([{Accept:"*/*"},n==null?void 0:n.headers])}))}hangup(e,t){return this._client.post(g`/realtime/calls/${e}/hangup`,u(o({},t),{headers:b([{Accept:"*/*"},t==null?void 0:t.headers])}))}refer(e,t,n){return this._client.post(g`/realtime/calls/${e}/refer`,u(o({body:t},n),{headers:b([{Accept:"*/*"},n==null?void 0:n.headers])}))}reject(e,t={},n){return this._client.post(g`/realtime/calls/${e}/reject`,u(o({body:t},n),{headers:b([{Accept:"*/*"},n==null?void 0:n.headers])}))}}class Vr extends S{create(e,t){return this._client.post("/realtime/client_secrets",o({body:e},t))}}class Xt extends S{constructor(){super(...arguments),this.clientSecrets=new Vr(this._client),this.calls=new qr(this._client)}}Xt.ClientSecrets=Vr;Xt.Calls=qr;function gi(s,e){return!e||!wi(e)?u(o({},s),{output_parsed:null,output:s.output.map(t=>t.type==="function_call"?u(o({},t),{parsed_arguments:null}):t.type==="message"?u(o({},t),{content:t.content.map(n=>u(o({},n),{parsed:null}))}):t)}):Jr(s,e)}function Jr(s,e){const t=s.output.map(r=>{if(r.type==="function_call")return u(o({},r),{parsed_arguments:vi(e,r)});if(r.type==="message"){const a=r.content.map(i=>i.type==="output_text"?u(o({},i),{parsed:_i(e,i.text)}):i);return u(o({},r),{content:a})}return r}),n=Object.assign({},s,{output:t});return Object.getOwnPropertyDescriptor(s,"output_text")||bn(n),Object.defineProperty(n,"output_parsed",{enumerable:!0,get(){for(const r of n.output)if(r.type==="message"){for(const a of r.content)if(a.type==="output_text"&&a.parsed!==null)return a.parsed}return null}}),n}function _i(s,e){var t,n,r,a;return((n=(t=s.text)==null?void 0:t.format)==null?void 0:n.type)!=="json_schema"?null:"$parseRaw"in((r=s.text)==null?void 0:r.format)?((a=s.text)==null?void 0:a.format).$parseRaw(e):JSON.parse(e)}function wi(s){var e;return!!Cn((e=s.text)==null?void 0:e.format)}function yi(s){return(s==null?void 0:s.$brand)==="auto-parseable-tool"}function bi(s,e){return s.find(t=>t.type==="function"&&t.name===e)}function vi(s,e){var n;const t=bi((n=s.tools)!=null?n:[],e.name);return u(o(o({},e),e),{parsed_arguments:yi(t)?t.$parseRaw(e.arguments):t!=null&&t.strict?JSON.parse(e.arguments):null})}function bn(s){const e=[];for(const t of s.output)if(t.type==="message")for(const n of t.content)n.type==="output_text"&&e.push(n.text);s.output_text=e.join("")}var $e,bt,be,vt,ys,bs,vs,As;class jn extends En{constructor(e){super(),$e.add(this),bt.set(this,void 0),be.set(this,void 0),vt.set(this,void 0),I(this,bt,e)}static createResponse(e,t,n){const r=new jn(t);return r._run(()=>r._createOrRetrieveResponse(e,t,u(o({},n),{headers:u(o({},n==null?void 0:n.headers),{"X-Stainless-Helper-Method":"stream"})}))),r}_createOrRetrieveResponse(e,t,n){return _(this,null,function*(){var l,m;const r=n==null?void 0:n.signal;r&&(r.aborted&&this.controller.abort(),r.addEventListener("abort",()=>this.controller.abort())),c(this,$e,"m",ys).call(this);let a,i=null;"response_id"in t?(a=yield e.responses.retrieve(t.response_id,{stream:!0},u(o({},n),{signal:this.controller.signal,stream:!0})),i=(l=t.starting_after)!=null?l:null):a=yield e.responses.create(u(o({},t),{stream:!0}),u(o({},n),{signal:this.controller.signal})),this._connected();try{for(var p=G(a),d,w,f;d=!(w=yield p.next()).done;d=!1){const h=w.value;c(this,$e,"m",bs).call(this,h,i)}}catch(w){f=[w]}finally{try{d&&(w=p.return)&&(yield w.call(p))}finally{if(f)throw f[0]}}if((m=a.controller.signal)!=null&&m.aborted)throw new ie;return c(this,$e,"m",vs).call(this)})}[(bt=new WeakMap,be=new WeakMap,vt=new WeakMap,$e=new WeakSet,ys=function(){this.ended||I(this,be,void 0)},bs=function(t,n){if(this.ended)return;const r=(i,l)=>{(n==null||l.sequence_number>n)&&this._emit(i,l)},a=c(this,$e,"m",As).call(this,t);switch(r("event",t),t.type){case"response.output_text.delta":{const i=a.output[t.output_index];if(!i)throw new R(`missing output at index ${t.output_index}`);if(i.type==="message"){const l=i.content[t.content_index];if(!l)throw new R(`missing content at index ${t.content_index}`);if(l.type!=="output_text")throw new R(`expected content to be 'output_text', got ${l.type}`);r("response.output_text.delta",u(o({},t),{snapshot:l.text}))}break}case"response.function_call_arguments.delta":{const i=a.output[t.output_index];if(!i)throw new R(`missing output at index ${t.output_index}`);i.type==="function_call"&&r("response.function_call_arguments.delta",u(o({},t),{snapshot:i.arguments}));break}default:r(t.type,t);break}},vs=function(){if(this.ended)throw new R("stream has ended, this shouldn't happen");const t=c(this,be,"f");if(!t)throw new R("request ended without sending any events");I(this,be,void 0);const n=Ai(t,c(this,bt,"f"));return I(this,vt,n),n},As=function(t){var r;let n=c(this,be,"f");if(!n){if(t.type!=="response.created")throw new R(`When snapshot hasn't been set yet, expected 'response.created' event, got ${t.type}`);return n=I(this,be,t.response),n}switch(t.type){case"response.output_item.added":{n.output.push(t.item);break}case"response.content_part.added":{const a=n.output[t.output_index];if(!a)throw new R(`missing output at index ${t.output_index}`);const i=a.type,l=t.part;i==="message"&&l.type!=="reasoning_text"?a.content.push(l):i==="reasoning"&&l.type==="reasoning_text"&&(a.content||(a.content=[]),a.content.push(l));break}case"response.output_text.delta":{const a=n.output[t.output_index];if(!a)throw new R(`missing output at index ${t.output_index}`);if(a.type==="message"){const i=a.content[t.content_index];if(!i)throw new R(`missing content at index ${t.content_index}`);if(i.type!=="output_text")throw new R(`expected content to be 'output_text', got ${i.type}`);i.text+=t.delta}break}case"response.function_call_arguments.delta":{const a=n.output[t.output_index];if(!a)throw new R(`missing output at index ${t.output_index}`);a.type==="function_call"&&(a.arguments+=t.delta);break}case"response.reasoning_text.delta":{const a=n.output[t.output_index];if(!a)throw new R(`missing output at index ${t.output_index}`);if(a.type==="reasoning"){const i=(r=a.content)==null?void 0:r[t.content_index];if(!i)throw new R(`missing content at index ${t.content_index}`);if(i.type!=="reasoning_text")throw new R(`expected content to be 'reasoning_text', got ${i.type}`);i.text+=t.delta}break}case"response.completed":{I(this,be,t.response);break}}return n},Symbol.asyncIterator)](){const e=[],t=[];let n=!1;return this.on("event",r=>{const a=t.shift();a?a.resolve(r):e.push(r)}),this.on("end",()=>{n=!0;for(const r of t)r.resolve(void 0);t.length=0}),this.on("abort",r=>{n=!0;for(const a of t)a.reject(r);t.length=0}),this.on("error",r=>{n=!0;for(const a of t)a.reject(r);t.length=0}),{next:()=>_(this,null,function*(){return e.length?{value:e.shift(),done:!1}:n?{value:void 0,done:!0}:new Promise((a,i)=>t.push({resolve:a,reject:i})).then(a=>a?{value:a,done:!1}:{value:void 0,done:!0})}),return:()=>_(this,null,function*(){return this.abort(),{value:void 0,done:!0}})}}finalResponse(){return _(this,null,function*(){yield this.done();const e=c(this,vt,"f");if(!e)throw new R("stream ended without producing a ChatCompletion");return e})}}function Ai(s,e){return gi(s,e)}class Xr extends S{list(e,t={},n){return this._client.getAPIList(g`/responses/${e}/input_items`,j,o({query:t},n))}}class Kr extends S{count(e={},t){return this._client.post("/responses/input_tokens",o({body:e},t))}}class Kt extends S{constructor(){super(...arguments),this.inputItems=new Xr(this._client),this.inputTokens=new Kr(this._client)}create(e,t){var n;return this._client.post("/responses",u(o({body:e},t),{stream:(n=e.stream)!=null?n:!1}))._thenUnwrap(r=>("object"in r&&r.object==="response"&&bn(r),r))}retrieve(e,t={},n){var r;return this._client.get(g`/responses/${e}`,u(o({query:t},n),{stream:(r=t==null?void 0:t.stream)!=null?r:!1}))._thenUnwrap(a=>("object"in a&&a.object==="response"&&bn(a),a))}delete(e,t){return this._client.delete(g`/responses/${e}`,u(o({},t),{headers:b([{Accept:"*/*"},t==null?void 0:t.headers])}))}parse(e,t){return this._client.responses.create(e,t)._thenUnwrap(n=>Jr(n,e))}stream(e,t){return jn.createResponse(this._client,e,t)}cancel(e,t){return this._client.post(g`/responses/${e}/cancel`,t)}}Kt.InputItems=Xr;Kt.InputTokens=Kr;class zr extends S{create(e,t,n){return this._client.post(g`/uploads/${e}/parts`,Ce(o({body:t},n),this._client))}}class qn extends S{constructor(){super(...arguments),this.parts=new zr(this._client)}create(e,t){return this._client.post("/uploads",o({body:e},t))}cancel(e,t){return this._client.post(g`/uploads/${e}/cancel`,t)}complete(e,t,n){return this._client.post(g`/uploads/${e}/complete`,o({body:t},n))}}qn.Parts=zr;const Si=s=>_(void 0,null,function*(){const e=yield Promise.allSettled(s),t=e.filter(r=>r.status==="rejected");if(t.length){for(const r of t)console.error(r.reason);throw new Error(`${t.length} promise(s) failed - see the above errors`)}const n=[];for(const r of e)r.status==="fulfilled"&&n.push(r.value);return n});class Qr extends S{create(e,t,n){return this._client.post(g`/vector_stores/${e}/file_batches`,u(o({body:t},n),{headers:b([{"OpenAI-Beta":"assistants=v2"},n==null?void 0:n.headers])}))}retrieve(e,t,n){const{vector_store_id:r}=t;return this._client.get(g`/vector_stores/${r}/file_batches/${e}`,u(o({},n),{headers:b([{"OpenAI-Beta":"assistants=v2"},n==null?void 0:n.headers])}))}cancel(e,t,n){const{vector_store_id:r}=t;return this._client.post(g`/vector_stores/${r}/file_batches/${e}/cancel`,u(o({},n),{headers:b([{"OpenAI-Beta":"assistants=v2"},n==null?void 0:n.headers])}))}createAndPoll(e,t,n){return _(this,null,function*(){const r=yield this.create(e,t);return yield this.poll(e,r.id,n)})}listFiles(e,t,n){const i=t,{vector_store_id:r}=i,a=F(i,["vector_store_id"]);return this._client.getAPIList(g`/vector_stores/${r}/file_batches/${e}/files`,j,u(o({query:a},n),{headers:b([{"OpenAI-Beta":"assistants=v2"},n==null?void 0:n.headers])}))}poll(e,t,n){return _(this,null,function*(){var a,i;const r=b([n==null?void 0:n.headers,{"X-Stainless-Poll-Helper":"true","X-Stainless-Custom-Poll-Interval":(i=(a=n==null?void 0:n.pollIntervalMs)==null?void 0:a.toString())!=null?i:void 0}]);for(;;){const{data:l,response:p}=yield this.retrieve(t,{vector_store_id:e},u(o({},n),{headers:r})).withResponse();switch(l.status){case"in_progress":let d=5e3;if(n!=null&&n.pollIntervalMs)d=n.pollIntervalMs;else{const w=p.headers.get("openai-poll-after-ms");if(w){const f=parseInt(w);isNaN(f)||(d=f)}}yield rt(d);break;case"failed":case"cancelled":case"completed":return l}}})}uploadAndPoll(a,i,l){return _(this,arguments,function*(e,{files:t,fileIds:n=[]},r){var C;if(t==null||t.length==0)throw new Error("No `files` provided to process. If you've already uploaded files you should use `.createAndPoll()` instead");const p=(C=r==null?void 0:r.maxConcurrency)!=null?C:5,d=Math.min(p,t.length),w=this._client,f=t.values(),m=[...n];function h(P){return _(this,null,function*(){for(let v of P){const k=yield w.files.create({file:v,purpose:"assistants"},r);m.push(k.id)}})}const y=Array(d).fill(f).map(h);return yield Si(y),yield this.createAndPoll(e,{file_ids:m})})}}class Gr extends S{create(e,t,n){return this._client.post(g`/vector_stores/${e}/files`,u(o({body:t},n),{headers:b([{"OpenAI-Beta":"assistants=v2"},n==null?void 0:n.headers])}))}retrieve(e,t,n){const{vector_store_id:r}=t;return this._client.get(g`/vector_stores/${r}/files/${e}`,u(o({},n),{headers:b([{"OpenAI-Beta":"assistants=v2"},n==null?void 0:n.headers])}))}update(e,t,n){const i=t,{vector_store_id:r}=i,a=F(i,["vector_store_id"]);return this._client.post(g`/vector_stores/${r}/files/${e}`,u(o({body:a},n),{headers:b([{"OpenAI-Beta":"assistants=v2"},n==null?void 0:n.headers])}))}list(e,t={},n){return this._client.getAPIList(g`/vector_stores/${e}/files`,j,u(o({query:t},n),{headers:b([{"OpenAI-Beta":"assistants=v2"},n==null?void 0:n.headers])}))}delete(e,t,n){const{vector_store_id:r}=t;return this._client.delete(g`/vector_stores/${r}/files/${e}`,u(o({},n),{headers:b([{"OpenAI-Beta":"assistants=v2"},n==null?void 0:n.headers])}))}createAndPoll(e,t,n){return _(this,null,function*(){const r=yield this.create(e,t,n);return yield this.poll(e,r.id,n)})}poll(e,t,n){return _(this,null,function*(){var a,i;const r=b([n==null?void 0:n.headers,{"X-Stainless-Poll-Helper":"true","X-Stainless-Custom-Poll-Interval":(i=(a=n==null?void 0:n.pollIntervalMs)==null?void 0:a.toString())!=null?i:void 0}]);for(;;){const l=yield this.retrieve(t,{vector_store_id:e},u(o({},n),{headers:r})).withResponse(),p=l.data;switch(p.status){case"in_progress":let d=5e3;if(n!=null&&n.pollIntervalMs)d=n.pollIntervalMs;else{const w=l.response.headers.get("openai-poll-after-ms");if(w){const f=parseInt(w);isNaN(f)||(d=f)}}yield rt(d);break;case"failed":case"completed":return p}}})}upload(e,t,n){return _(this,null,function*(){const r=yield this._client.files.create({file:t,purpose:"assistants"},n);return this.create(e,{file_id:r.id},n)})}uploadAndPoll(e,t,n){return _(this,null,function*(){const r=yield this.upload(e,t,n);return yield this.poll(e,r.id,n)})}content(e,t,n){const{vector_store_id:r}=t;return this._client.getAPIList(g`/vector_stores/${r}/files/${e}/content`,jt,u(o({},n),{headers:b([{"OpenAI-Beta":"assistants=v2"},n==null?void 0:n.headers])}))}}class zt extends S{constructor(){super(...arguments),this.files=new Gr(this._client),this.fileBatches=new Qr(this._client)}create(e,t){return this._client.post("/vector_stores",u(o({body:e},t),{headers:b([{"OpenAI-Beta":"assistants=v2"},t==null?void 0:t.headers])}))}retrieve(e,t){return this._client.get(g`/vector_stores/${e}`,u(o({},t),{headers:b([{"OpenAI-Beta":"assistants=v2"},t==null?void 0:t.headers])}))}update(e,t,n){return this._client.post(g`/vector_stores/${e}`,u(o({body:t},n),{headers:b([{"OpenAI-Beta":"assistants=v2"},n==null?void 0:n.headers])}))}list(e={},t){return this._client.getAPIList("/vector_stores",j,u(o({query:e},t),{headers:b([{"OpenAI-Beta":"assistants=v2"},t==null?void 0:t.headers])}))}delete(e,t){return this._client.delete(g`/vector_stores/${e}`,u(o({},t),{headers:b([{"OpenAI-Beta":"assistants=v2"},t==null?void 0:t.headers])}))}search(e,t,n){return this._client.getAPIList(g`/vector_stores/${e}/search`,jt,u(o({body:t,method:"post"},n),{headers:b([{"OpenAI-Beta":"assistants=v2"},n==null?void 0:n.headers])}))}}zt.Files=Gr;zt.FileBatches=Qr;class Yr extends S{create(e,t){return this._client.post("/videos",os(o({body:e},t),this._client))}retrieve(e,t){return this._client.get(g`/videos/${e}`,t)}list(e={},t){return this._client.getAPIList("/videos",Mt,o({query:e},t))}delete(e,t){return this._client.delete(g`/videos/${e}`,t)}downloadContent(e,t={},n){return this._client.get(g`/videos/${e}/content`,u(o({query:t},n),{headers:b([{Accept:"application/binary"},n==null?void 0:n.headers]),__binaryResponse:!0}))}remix(e,t,n){return this._client.post(g`/videos/${e}/remix`,os(o({body:t},n),this._client))}}var Le,Zr,Et;class ea extends S{constructor(){super(...arguments),Le.add(this)}unwrap(a,i){return _(this,arguments,function*(e,t,n=this._client.webhookSecret,r=300){return yield this.verifySignature(e,t,n,r),JSON.parse(e)})}verifySignature(a,i){return _(this,arguments,function*(e,t,n=this._client.webhookSecret,r=300){if(typeof crypto=="undefined"||typeof crypto.subtle.importKey!="function"||typeof crypto.subtle.verify!="function")throw new Error("Webhook signature verification is only supported when the `crypto` global is defined");c(this,Le,"m",Zr).call(this,n);const l=b([t]).values,p=c(this,Le,"m",Et).call(this,l,"webhook-signature"),d=c(this,Le,"m",Et).call(this,l,"webhook-timestamp"),w=c(this,Le,"m",Et).call(this,l,"webhook-id"),f=parseInt(d,10);if(isNaN(f))throw new Ve("Invalid webhook timestamp format");const m=Math.floor(Date.now()/1e3);if(m-f>r)throw new Ve("Webhook timestamp is too old");if(f>m+r)throw new Ve("Webhook timestamp is too new");const h=p.split(" ").map(v=>v.startsWith("v1,")?v.substring(3):v),y=n.startsWith("whsec_")?Buffer.from(n.replace("whsec_",""),"base64"):Buffer.from(n,"utf-8"),C=w?`${w}.${d}.${e}`:`${d}.${e}`,P=yield crypto.subtle.importKey("raw",y,{name:"HMAC",hash:"SHA-256"},!1,["verify"]);for(const v of h)try{const k=Buffer.from(v,"base64");if(yield crypto.subtle.verify("HMAC",P,k,new TextEncoder().encode(C)))return}catch(k){continue}throw new Ve("The given webhook signature does not match the expected signature")})}}Le=new WeakSet,Zr=function(e){if(typeof e!="string"||e.length===0)throw new Error("The webhook secret must either be set using the env var, OPENAI_WEBHOOK_SECRET, on the client class, OpenAI({ webhookSecret: '123' }), or passed to this function")},Et=function(e,t){if(!e)throw new Error("Headers are required");const n=e.get(t);if(n==null)throw new Error(`Missing required header: ${t}`);return n};var vn,Vn,Pt,ta;class E{constructor(w={}){var f=w,{baseURL:e=Pe("OPENAI_BASE_URL"),apiKey:t=Pe("OPENAI_API_KEY"),organization:n=(l=>(l=Pe("OPENAI_ORG_ID"))!=null?l:null)(),project:r=(p=>(p=Pe("OPENAI_PROJECT_ID"))!=null?p:null)(),webhookSecret:a=(d=>(d=Pe("OPENAI_WEBHOOK_SECRET"))!=null?d:null)()}=f,i=F(f,["baseURL","apiKey","organization","project","webhookSecret"]);var y,C,P,v,k,D;if(vn.add(this),Pt.set(this,void 0),this.completions=new Pr(this),this.chat=new Mn(this),this.embeddings=new Or(this),this.files=new Lr(this),this.images=new Hr(this),this.audio=new it(this),this.moderations=new jr(this),this.models=new Ur(this),this.fineTuning=new We(this),this.graders=new Un(this),this.vectorStores=new zt(this),this.webhooks=new ea(this),this.beta=new Fe(this),this.batches=new Ar(this),this.uploads=new qn(this),this.responses=new Kt(this),this.realtime=new Xt(this),this.conversations=new Nn(this),this.evals=new Fn(this),this.containers=new Ln(this),this.videos=new Yr(this),t===void 0)throw new R("Missing credentials. Please pass an `apiKey`, or set the `OPENAI_API_KEY` environment variable.");const m=u(o({apiKey:t,organization:n,project:r,webhookSecret:a},i),{baseURL:e||"https://api.openai.com/v1"});if(!m.dangerouslyAllowBrowser&&xa())throw new R(`It looks like you're running in a browser-like environment.

This is disabled by default, as it risks exposing your secret API credentials to attackers.
If you understand the risks and have appropriate mitigations in place,
you can set the \`dangerouslyAllowBrowser\` option to \`true\`, e.g.,

new OpenAI({ apiKey, dangerouslyAllowBrowser: true });

https://help.openai.com/en/articles/5112595-best-practices-for-api-key-safety
`);this.baseURL=m.baseURL,this.timeout=(y=m.timeout)!=null?y:Vn.DEFAULT_TIMEOUT,this.logger=(C=m.logger)!=null?C:console;const h="warn";this.logLevel=h,this.logLevel=(v=(P=as(m.logLevel,"ClientOptions.logLevel",this))!=null?P:as(Pe("OPENAI_LOG"),"process.env['OPENAI_LOG']",this))!=null?v:h,this.fetchOptions=m.fetchOptions,this.maxRetries=(k=m.maxRetries)!=null?k:2,this.fetch=(D=m.fetch)!=null?D:Pa(),I(this,Pt,Ma),this._options=m,this.apiKey=typeof t=="string"?t:"Missing Key",this.organization=n,this.project=r,this.webhookSecret=a}withOptions(e){return new this.constructor(o(u(o({},this._options),{baseURL:this.baseURL,maxRetries:this.maxRetries,timeout:this.timeout,logger:this.logger,logLevel:this.logLevel,fetch:this.fetch,fetchOptions:this.fetchOptions,apiKey:this.apiKey,organization:this.organization,project:this.project,webhookSecret:this.webhookSecret}),e))}defaultQuery(){return this._options.defaultQuery}validateHeaders({values:e,nulls:t}){}authHeaders(e){return _(this,null,function*(){return b([{Authorization:`Bearer ${this.apiKey}`}])})}stringifyQuery(e){return Fa(e,{arrayFormat:"brackets"})}getUserAgent(){return`${this.constructor.name}/JS ${Oe}`}defaultIdempotencyKey(){return`stainless-node-retry-${Rs()}`}makeStatusError(e,t,n,r){return Q.generate(e,t,n,r)}_callApiKey(){return _(this,null,function*(){const e=this._options.apiKey;if(typeof e!="function")return!1;let t;try{t=yield e()}catch(n){throw n instanceof R?n:new R(`Failed to get token from 'apiKey' function: ${n.message}`,{cause:n})}if(typeof t!="string"||!t)throw new R(`Expected 'apiKey' function argument to return a string but it returned ${t}`);return this.apiKey=t,!0})}buildURL(e,t,n){const r=!c(this,vn,"m",ta).call(this)&&n||this.baseURL,a=ba(e)?new URL(e):new URL(r+(r.endsWith("/")&&e.startsWith("/")?e.slice(1):e)),i=this.defaultQuery();return va(i)||(t=o(o({},i),t)),typeof t=="object"&&t&&!Array.isArray(t)&&(a.search=this.stringifyQuery(t)),a.toString()}prepareOptions(e){return _(this,null,function*(){yield this._callApiKey()})}prepareRequest(r,a){return _(this,arguments,function*(e,{url:t,options:n}){})}get(e,t){return this.methodRequest("get",e,t)}post(e,t){return this.methodRequest("post",e,t)}patch(e,t){return this.methodRequest("patch",e,t)}put(e,t){return this.methodRequest("put",e,t)}delete(e,t){return this.methodRequest("delete",e,t)}methodRequest(e,t,n){return this.request(Promise.resolve(n).then(r=>o({method:e,path:t},r)))}request(e,t=null){return new Ut(this,this.makeRequest(e,t,void 0))}makeRequest(e,t,n){return _(this,null,function*(){var v,k,D;const r=yield e,a=(v=r.maxRetries)!=null?v:this.maxRetries;t==null&&(t=a),yield this.prepareOptions(r);const{req:i,url:l,timeout:p}=yield this.buildRequest(r,{retryCount:a-t});yield this.prepareRequest(i,{url:l,options:r});const d="log_"+(Math.random()*(1<<24)|0).toString(16).padStart(6,"0"),w=n===void 0?"":`, retryOf: ${n}`,f=Date.now();if(K(this).debug(`[${d}] sending request`,Se({retryOfRequestLogID:n,method:r.method,url:l,options:r,headers:i.headers})),(k=r.signal)!=null&&k.aborted)throw new ie;const m=new AbortController,h=yield this.fetchWithTimeout(l,i,p,m).catch(cn),y=Date.now();if(h instanceof globalThis.Error){const O=`retrying, ${t} attempts remaining`;if((D=r.signal)!=null&&D.aborted)throw new ie;const T=ln(h)||/timed? ?out/i.test(String(h)+("cause"in h?String(h.cause):""));if(t)return K(this).info(`[${d}] connection ${T?"timed out":"failed"} - ${O}`),K(this).debug(`[${d}] connection ${T?"timed out":"failed"} (${O})`,Se({retryOfRequestLogID:n,url:l,durationMs:y-f,message:h.message})),this.retryRequest(r,t,n!=null?n:d);throw K(this).info(`[${d}] connection ${T?"timed out":"failed"} - error; no more retries left`),K(this).debug(`[${d}] connection ${T?"timed out":"failed"} (error; no more retries left)`,Se({retryOfRequestLogID:n,url:l,durationMs:y-f,message:h.message})),T?new Sn:new Bt({cause:h})}const C=[...h.headers.entries()].filter(([O])=>O==="x-request-id").map(([O,T])=>", "+O+": "+JSON.stringify(T)).join(""),P=`[${d}${w}${C}] ${i.method} ${l} ${h.ok?"succeeded":"failed"} with status ${h.status} in ${y-f}ms`;if(!h.ok){const O=yield this.shouldRetry(h);if(t&&O){const $=`retrying, ${t} attempts remaining`;return yield $a(h.body),K(this).info(`${P} - ${$}`),K(this).debug(`[${d}] response error (${$})`,Se({retryOfRequestLogID:n,url:h.url,status:h.status,headers:h.headers,durationMs:y-f})),this.retryRequest(r,t,n!=null?n:d,h.headers)}const T=O?"error; no more retries left":"error; not retryable";K(this).info(`${P} - ${T}`);const H=yield h.text().catch($=>cn($).message),U=Ra(H),L=U?void 0:H;throw K(this).debug(`[${d}] response error (${T})`,Se({retryOfRequestLogID:n,url:h.url,status:h.status,headers:h.headers,message:L,durationMs:Date.now()-f})),this.makeStatusError(h.status,U,L,h.headers)}return K(this).info(P),K(this).debug(`[${d}] response start`,Se({retryOfRequestLogID:n,url:h.url,status:h.status,headers:h.headers,durationMs:y-f})),{response:h,options:r,controller:m,requestLogID:d,retryOfRequestLogID:n,startTime:f}})}getAPIList(e,t,n){return this.requestAPIList(t,o({method:"get",path:e},n))}requestAPIList(e,t){const n=this.makeRequest(t,null,void 0);return new Xa(this,n,e)}fetchWithTimeout(e,t,n,r){return _(this,null,function*(){const f=t||{},{signal:a,method:i}=f,l=F(f,["signal","method"]);a&&a.addEventListener("abort",()=>r.abort());const p=setTimeout(()=>r.abort(),n),d=globalThis.ReadableStream&&l.body instanceof globalThis.ReadableStream||typeof l.body=="object"&&l.body!==null&&Symbol.asyncIterator in l.body,w=o(u(o({signal:r.signal},d?{duplex:"half"}:{}),{method:"GET"}),l);i&&(w.method=i.toUpperCase());try{return yield this.fetch.call(void 0,e,w)}finally{clearTimeout(p)}})}shouldRetry(e){return _(this,null,function*(){const t=e.headers.get("x-should-retry");return t==="true"?!0:t==="false"?!1:e.status===408||e.status===409||e.status===429||e.status>=500})}retryRequest(e,t,n,r){return _(this,null,function*(){var p;let a;const i=r==null?void 0:r.get("retry-after-ms");if(i){const d=parseFloat(i);Number.isNaN(d)||(a=d)}const l=r==null?void 0:r.get("retry-after");if(l&&!a){const d=parseFloat(l);Number.isNaN(d)?a=Date.parse(l)-Date.now():a=d*1e3}if(!(a&&0<=a&&a<60*1e3)){const d=(p=e.maxRetries)!=null?p:this.maxRetries;a=this.calculateDefaultRetryTimeoutMillis(t,d)}return yield rt(a),this.makeRequest(e,t-1,n)})}calculateDefaultRetryTimeoutMillis(e,t){const a=t-e,i=Math.min(.5*Math.pow(2,a),8),l=1-Math.random()*.25;return i*l*1e3}buildRequest(n){return _(this,arguments,function*(e,{retryCount:t=0}={}){var y,C,P;const r=o({},e),{method:a,path:i,query:l,defaultBaseURL:p}=r,d=this.buildURL(i,l,p);"timeout"in r&&Sa("timeout",r.timeout),r.timeout=(y=r.timeout)!=null?y:this.timeout;const{bodyHeaders:w,body:f}=this.buildBody({options:r}),m=yield this.buildHeaders({options:e,method:a,bodyHeaders:w,retryCount:t});return{req:o(o(o(o(o({method:a,headers:m},r.signal&&{signal:r.signal}),globalThis.ReadableStream&&f instanceof globalThis.ReadableStream&&{duplex:"half"}),f&&{body:f}),(C=this.fetchOptions)!=null?C:{}),(P=r.fetchOptions)!=null?P:{}),url:d,timeout:r.timeout}})}buildHeaders(a){return _(this,arguments,function*({options:e,method:t,bodyHeaders:n,retryCount:r}){let i={};this.idempotencyHeader&&t!=="get"&&(e.idempotencyKey||(e.idempotencyKey=this.defaultIdempotencyKey()),i[this.idempotencyHeader]=e.idempotencyKey);const l=b([i,u(o(o({Accept:"application/json","User-Agent":this.getUserAgent(),"X-Stainless-Retry-Count":String(r)},e.timeout?{"X-Stainless-Timeout":String(Math.trunc(e.timeout/1e3))}:{}),Ea()),{"OpenAI-Organization":this.organization,"OpenAI-Project":this.project}),yield this.authHeaders(e),this._options.defaultHeaders,n,e.headers]);return this.validateHeaders(l),l.values})}buildBody({options:{body:e,headers:t}}){if(!e)return{bodyHeaders:void 0,body:void 0};const n=b([t]);return ArrayBuffer.isView(e)||e instanceof ArrayBuffer||e instanceof DataView||typeof e=="string"&&n.values.has("content-type")||globalThis.Blob&&e instanceof globalThis.Blob||e instanceof FormData||e instanceof URLSearchParams||globalThis.ReadableStream&&e instanceof globalThis.ReadableStream?{bodyHeaders:void 0,body:e}:typeof e=="object"&&(Symbol.asyncIterator in e||Symbol.iterator in e&&"next"in e&&typeof e.next=="function")?{bodyHeaders:void 0,body:Ds(e)}:c(this,Pt,"f").call(this,{body:e,headers:n})}}Vn=E,Pt=new WeakMap,vn=new WeakSet,ta=function(){return this.baseURL!=="https://api.openai.com/v1"};E.OpenAI=Vn;E.DEFAULT_TIMEOUT=6e5;E.OpenAIError=R;E.APIError=Q;E.APIConnectionError=Bt;E.APIConnectionTimeoutError=Sn;E.APIUserAbortError=ie;E.NotFoundError=Is;E.ConflictError=Es;E.RateLimitError=$s;E.BadRequestError=xs;E.AuthenticationError=ks;E.InternalServerError=Ms;E.PermissionDeniedError=Cs;E.UnprocessableEntityError=Ps;E.InvalidWebhookSignatureError=Ve;E.toFile=Ya;E.Completions=Pr;E.Chat=Mn;E.Embeddings=Or;E.Files=Lr;E.Images=Hr;E.Audio=it;E.Moderations=jr;E.Models=Ur;E.FineTuning=We;E.Graders=Un;E.VectorStores=zt;E.Webhooks=ea;E.Beta=Fe;E.Batches=Ar;E.Uploads=qn;E.Responses=Kt;E.Realtime=Xt;E.Conversations=Nn;E.Evals=Fn;E.Containers=Ln;E.Videos=Yr;class Ri{constructor(){this.availableModels=[{value:"saas.deepseek-v3",label:"DeepSeek V3"},{value:"saas.deepseek-r1",label:"DeepSeek R1"},{value:"saas.qwen3-235b-a22b-thinking",label:"Qwen3 235B Thinking"},{value:"saas.qwen3-235b-a22b-instruct",label:"Qwen3 235B Instruct"},{value:"saas.text-embedding-v4",label:"Text Embedding V4"},{value:"saas.doubao-seed-1.6-flash",label:"Doubao Seed 1.6 Flash"},{value:"saas.doubao-seed-1.6",label:"Doubao Seed 1.6"},{value:"saas.qwen3-next-80b-a3b-thinking",label:"Qwen3 Next 80B Thinking"},{value:"saas.qwen3-next-80b-a3b-instruct",label:"Qwen3 Next 80B Instruct"}],this.selectedModel="saas.qwen3-235b-a22b-instruct",this.init()}init(){try{console.log("AI..."),this.client=new E({apiKey:"sk-30D2dKJKy7ki-mHomyDV5g",baseURL:"http://genai-sharedservice-uat.cn.asia.pwcinternal.com/v1",dangerouslyAllowBrowser:!0}),console.log("AI")}catch(e){throw console.error("AI:",e),e}}setModel(e){return this.availableModels.some(t=>t.value===e)?(this.selectedModel=e,!0):!1}predictNextLottery(e){return _(this,null,function*(){try{console.log("AI..."),console.log(":",e.length);const t=this.buildHistoryPrompt(e);console.log("");const n=`3D

${t}


1. 
2. 
3. 3D
4. 3000-999
5. 

XXX`;console.log("AI:",this.selectedModel);const r=yield this.client.chat.completions.create({model:this.selectedModel,messages:[{role:"system",content:"3D"},{role:"user",content:n}],max_tokens:500,temperature:.7});console.log("AI API:",r);const a=r.choices[0].message.content;console.log(":",a);const i=this.parsePredictionResult(a);return console.log(":",i),i}catch(t){throw console.error("AI:",t),console.error(":",t.message),console.error(":",t.stack),new Error("AI")}})}buildHistoryPrompt(e){if(!e||e.length===0)return"";let t=`
`;e.slice(0,10).forEach((i,l)=>{t+=`${i.period}${i.result}${i.date}
`}),t+=`

`;const r=this.calculateNumberFrequency(e);t+=`${JSON.stringify(r)}
`;const a=this.calculateSumStatistics(e);return t+=`${a.min}-${a.max}${a.average.toFixed(2)}
`,t}calculateNumberFrequency(e){const t={};return e.forEach(n=>{n.result.split("").forEach(a=>{t[a]=(t[a]||0)+1})}),Object.entries(t).sort((n,r)=>r[1]-n[1]).reduce((n,[r,a])=>(n[r]=a,n),{})}calculateSumStatistics(e){const t=e.map(n=>n.result.split("").map(Number).reduce((a,i)=>a+i,0));return{min:Math.min(...t),max:Math.max(...t),average:t.reduce((n,r)=>n+r,0)/t.length}}parsePredictionResult(e){const t=e.match(/[:]\s*(\d{3})/),n=t?t[1]:null,r=e.match(/[:]([^]*)/),a=r?r[1].trim():"";return{prediction:n,reason:a,fullResponse:e}}getAvailableModels(){return this.availableModels}getSelectedModel(){return this.selectedModel}}const xi=new Ri;function na(){return/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)}function An(){if(na()){const s=window.location.pathname,e=window.location.hash;if(s!=="/"&&!s.includes("index.html")&&!["/ai-prediction","/betting-records","/match-four-code-by-danma","/advanced-prediction","/three-code-filter","/period-management","/code-maintenance","/four-code-maintenance","/kill-code-maintenance","/kill-two-code-maintenance","/three-code-deduplication","/advanced-data-recovery"].some(r=>s.includes(r)))return window.location.href="/",!1;if(e&&e.startsWith("#/")){const t=e.substring(2);validRoutes.map(r=>r.substring(1)).includes(t)||(window.location.hash="")}}return!0}function ki(){window.addEventListener("popstate",An),An(),console.log("")}function Ci(){if(window.matchMedia("(display-mode: standalone)").matches||window.navigator.standalone===!0||document.referrer.includes("android-app://")||window.location.href.includes("source=pwa")){console.log("PWAPWA");const e=window.location.pathname,t=window.location.href;if(e!=="/"&&!e.endsWith("index.html")&&!t.includes("index.html")){const r=`${window.location.origin}/index.html${window.location.pathname}${window.location.search}${window.location.hash}`;if(!t.includes("index.html"))return console.log("PWA:",r),window.location.replace(r),!1}window.addEventListener("hashchange",()=>{console.log("PWA hash:",window.location.hash)}),window.addEventListener("popstate",n=>{if(console.log("PWA popstate:",n.state),n.state&&n.state.route){const r=n.state.route;r.includes("index.html")||history.replaceState({route:`/index.html${r}`},"",`/index.html${r}`)}})}return!0}function Ii(){na()&&(window.addEventListener("online",()=>{console.log(""),An()}),window.addEventListener("offline",()=>{console.log("")}))}function sa(){var s;return window.matchMedia("(display-mode: standalone)").matches||window.navigator.standalone===!0||document.referrer.includes("android-app://")||window.location.href.includes("source=pwa")||((s=window.performance.getEntriesByType("navigation")[0])==null?void 0:s.type)==="navigate"&&window.location.protocol==="https:"&&!window.location.hostname.includes("localhost")}function et(){if(!sa())return!0;console.log("PWA");const s=window.location.pathname,e=window.location.href,t=window.location.hash;if(console.log("PWA:",{pathname:s,href:e,hash:t,search:window.location.search}),s==="/"||s.endsWith("index.html")){if(t&&t.startsWith("#/")){const a=t.substring(2);if(!["ai-prediction","betting-records","match-four-code-by-danma","advanced-prediction","three-code-filter","period-management","code-maintenance","four-code-maintenance","kill-code-maintenance","kill-two-code-maintenance","three-code-deduplication","advanced-data-recovery"].includes(a))return console.log("hashhash"),window.location.hash="",!1}return console.log("PWA"),!0}if(["/ai-prediction","/betting-records","/match-four-code-by-danma","/advanced-prediction","/three-code-filter","/period-management","/code-maintenance","/four-code-maintenance","/kill-code-maintenance","/kill-two-code-maintenance","/three-code-deduplication","/advanced-data-recovery"].some(a=>s.includes(a))){console.log("PWA");const i=`#/${s.substring(1)}`;if(!e.includes("#"))return console.log("PWA - hash:",i),window.location.replace(`/index.html${i}`),!1}else return console.log(""),window.location.replace("/index.html"),!1;return!0}function Ei(){sa()&&(console.log("PWA"),setTimeout(()=>{et()},100),window.addEventListener("hashchange",()=>{console.log("PWA hash:",window.location.hash),setTimeout(()=>{et()},50)}),window.addEventListener("popstate",s=>{if(console.log("PWA popstate:",s.state),s.state&&s.state.route){const e=s.state.route;e.includes("index.html")||history.replaceState({route:`/index.html${e}`},"",`/index.html${e}`)}setTimeout(()=>{et()},50)}),window.$router&&window.$router.afterEach((s,e)=>{console.log("Vue Router:",s.path),setTimeout(()=>{et()},50)}))}function Pi(){"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(s=>{console.log("Service WorkerPWA"),s.active&&s.active.postMessage({type:"PWA_ROUTE_OPTIMIZATION",data:{timestamp:Date.now(),routes:["/","/index.html","/ai-prediction","/betting-records","/match-four-code-by-danma","/advanced-prediction","/three-code-filter","/period-management","/code-maintenance","/four-code-maintenance","/kill-code-maintenance","/kill-two-code-maintenance","/three-code-deduplication","/advanced-data-recovery"]}})})}const $i=(s,e)=>{const t=s.__vccOpts||s;for(const[n,r]of e)t[n]=r;return t},Mi={name:"App",data(){return{isMobileMenuOpen:!1,isMobile:!1}},mounted(){this.checkMobileDevice(),window.addEventListener("resize",this.checkMobileDevice)},beforeDestroy(){window.removeEventListener("resize",this.checkMobileDevice)},methods:{checkMobileDevice(){this.isMobile=window.innerWidth<=768,this.isMobile&&this.isMobileMenuOpen&&(this.isMobileMenuOpen=!1)},toggleMobileMenu(){this.isMobile&&(this.isMobileMenuOpen=!this.isMobileMenuOpen)},closeMobileMenu(){this.isMobile&&(this.isMobileMenuOpen=!1)}}},Oi={class:"app-header desktop-header"},Ti={class:"app-nav desktop-nav"},Li={key:0,class:"mobile-arrow"},Ni={key:0,class:"mobile-header"},Di={key:1,class:"mobile-bottom-nav"},Fi={class:"menu-header"},Wi={class:"menu-items"};function Bi(s,e,t,n,r,a){const i=Gn("router-link"),l=Gn("router-view");return je(),Ue("div",{id:"app",class:ut({"mobile-device":r.isMobile})},[A("header",Oi,[e[23]||(e[23]=A("h1",null,"",-1)),e[24]||(e[24]=A("p",{class:"subtitle"},"3D",-1)),A("nav",Ti,[W(i,{to:"/ai-prediction",class:"nav-link","active-class":"active"},{default:B(()=>[...e[9]||(e[9]=[A("span",{class:"nav-icon"},"",-1),ne(" AI ",-1)])]),_:1}),W(i,{to:"/betting-records",class:"nav-link","active-class":"active"},{default:B(()=>[...e[10]||(e[10]=[A("span",{class:"nav-icon"},"",-1),ne(" 3D ",-1)])]),_:1}),W(i,{to:"/match-four-code-by-danma",class:"nav-link","active-class":"active"},{default:B(()=>[...e[11]||(e[11]=[A("span",{class:"nav-icon"},"",-1),ne("  ",-1)])]),_:1}),W(i,{to:"/advanced-prediction",class:"nav-link","active-class":"active"},{default:B(()=>[...e[12]||(e[12]=[A("span",{class:"nav-icon"},"",-1),ne("  ",-1)])]),_:1}),W(i,{to:"/three-code-filter",class:"nav-link","active-class":"active"},{default:B(()=>[...e[13]||(e[13]=[A("span",{class:"nav-icon"},"",-1),ne(" 3D ",-1)])]),_:1}),A("div",{class:ut(["nav-dropdown",{"mobile-open":r.isMobileMenuOpen}])},[A("button",{class:"nav-dropdown-toggle",onClick:e[0]||(e[0]=(...p)=>a.toggleMobileMenu&&a.toggleMobileMenu(...p)),onMouseenter:e[1]||(e[1]=p=>!r.isMobile&&(r.isMobileMenuOpen=!0)),onMouseleave:e[2]||(e[2]=p=>!r.isMobile&&(r.isMobileMenuOpen=!1))},[e[14]||(e[14]=A("span",{class:"nav-icon"},"",-1)),e[15]||(e[15]=ne("  ",-1)),r.isMobile?(je(),Ue("span",Li,da(r.isMobileMenuOpen?"":""),1)):ct("",!0)],32),A("div",{class:ut(["nav-dropdown-menu",{"mobile-visible":r.isMobileMenuOpen}]),onClick:e[3]||(e[3]=(...p)=>a.closeMobileMenu&&a.closeMobileMenu(...p))},[W(i,{to:"/period-management",class:"nav-dropdown-item","active-class":"active"},{default:B(()=>[...e[16]||(e[16]=[A("span",{class:"nav-icon"},"",-1),ne("  ",-1)])]),_:1}),W(i,{to:"/code-maintenance",class:"nav-dropdown-item","active-class":"active"},{default:B(()=>[...e[17]||(e[17]=[A("span",{class:"nav-icon"},"",-1),ne("  ",-1)])]),_:1}),W(i,{to:"/four-code-maintenance",class:"nav-dropdown-item","active-class":"active"},{default:B(()=>[...e[18]||(e[18]=[A("span",{class:"nav-icon"},"",-1),ne("  ",-1)])]),_:1}),W(i,{to:"/kill-code-maintenance",class:"nav-dropdown-item","active-class":"active"},{default:B(()=>[...e[19]||(e[19]=[A("span",{class:"nav-icon"},"",-1),ne("  ",-1)])]),_:1}),W(i,{to:"/kill-two-code-maintenance",class:"nav-dropdown-item","active-class":"active"},{default:B(()=>[...e[20]||(e[20]=[A("span",{class:"nav-icon"},"",-1),ne("  ",-1)])]),_:1}),W(i,{to:"/three-code-deduplication",class:"nav-dropdown-item","active-class":"active"},{default:B(()=>[...e[21]||(e[21]=[A("span",{class:"nav-icon"},"",-1),ne("  ",-1)])]),_:1}),W(i,{to:"/advanced-data-recovery",class:"nav-dropdown-item","active-class":"active"},{default:B(()=>[...e[22]||(e[22]=[A("span",{class:"nav-icon"},"",-1),ne("  ",-1)])]),_:1})],2)],2)])]),r.isMobile?(je(),Ue("header",Ni,[...e[25]||(e[25]=[A("div",{class:"mobile-title"},[A("p",{class:"mobile-subtitle"},"")],-1)])])):ct("",!0),A("main",{class:ut(["app-main",{"mobile-main":r.isMobile}])},[W(l)],2),r.isMobile?(je(),Ue("nav",Di,[W(i,{to:"/match-four-code-by-danma",class:"nav-item","active-class":"active"},{default:B(()=>[...e[26]||(e[26]=[A("span",{class:"nav-icon"},"",-1),A("span",{class:"nav-label"},"",-1)])]),_:1}),W(i,{to:"/advanced-prediction",class:"nav-item","active-class":"active"},{default:B(()=>[...e[27]||(e[27]=[A("span",{class:"nav-icon"},"",-1),A("span",{class:"nav-label"},"",-1)])]),_:1}),W(i,{to:"/three-code-deduplication",class:"nav-item","active-class":"active"},{default:B(()=>[...e[28]||(e[28]=[A("span",{class:"nav-icon"},"",-1),A("span",{class:"nav-label"},"",-1)])]),_:1}),W(i,{to:"/three-code-filter",class:"nav-item","active-class":"active"},{default:B(()=>[...e[29]||(e[29]=[A("span",{class:"nav-icon"},"",-1),A("span",{class:"nav-label"},"3D",-1)])]),_:1}),A("div",{class:"nav-item more-menu",onClick:e[4]||(e[4]=(...p)=>a.toggleMobileMenu&&a.toggleMobileMenu(...p))},[...e[30]||(e[30]=[A("span",{class:"nav-icon"},"",-1),A("span",{class:"nav-label"},"",-1)])])])):ct("",!0),r.isMobile&&r.isMobileMenuOpen?(je(),Ue("div",{key:2,class:"mobile-more-menu",onClick:e[8]||(e[8]=(...p)=>a.closeMobileMenu&&a.closeMobileMenu(...p))},[A("div",{class:"menu-overlay",onClick:e[5]||(e[5]=(...p)=>a.closeMobileMenu&&a.closeMobileMenu(...p))}),A("div",{class:"menu-content",onClick:e[7]||(e[7]=ha(()=>{},["stop"]))},[e[40]||(e[40]=A("div",{class:"menu-drag-handle"},null,-1)),A("div",Fi,[e[31]||(e[31]=A("h3",null,"",-1)),A("button",{class:"close-btn",onClick:e[6]||(e[6]=(...p)=>a.closeMobileMenu&&a.closeMobileMenu(...p))},"")]),A("div",Wi,[W(i,{to:"/period-management",class:"menu-item",onClick:a.closeMobileMenu},{default:B(()=>[...e[32]||(e[32]=[A("span",{class:"menu-icon"},"",-1),A("span",{class:"menu-label"},"",-1)])]),_:1},8,["onClick"]),W(i,{to:"/code-maintenance",class:"menu-item",onClick:a.closeMobileMenu},{default:B(()=>[...e[33]||(e[33]=[A("span",{class:"menu-icon"},"",-1),A("span",{class:"menu-label"},"",-1)])]),_:1},8,["onClick"]),W(i,{to:"/four-code-maintenance",class:"menu-item",onClick:a.closeMobileMenu},{default:B(()=>[...e[34]||(e[34]=[A("span",{class:"menu-icon"},"",-1),A("span",{class:"menu-label"},"",-1)])]),_:1},8,["onClick"]),W(i,{to:"/kill-code-maintenance",class:"menu-item",onClick:a.closeMobileMenu},{default:B(()=>[...e[35]||(e[35]=[A("span",{class:"menu-icon"},"",-1),A("span",{class:"menu-label"},"",-1)])]),_:1},8,["onClick"]),W(i,{to:"/kill-two-code-maintenance",class:"menu-item",onClick:a.closeMobileMenu},{default:B(()=>[...e[36]||(e[36]=[A("span",{class:"menu-icon"},"",-1),A("span",{class:"menu-label"},"",-1)])]),_:1},8,["onClick"]),W(i,{to:"/ai-prediction",class:"menu-item",onClick:a.closeMobileMenu},{default:B(()=>[...e[37]||(e[37]=[A("span",{class:"menu-icon"},"",-1),A("span",{class:"menu-label"},"AI",-1)])]),_:1},8,["onClick"]),W(i,{to:"/betting-records",class:"menu-item",onClick:a.closeMobileMenu},{default:B(()=>[...e[38]||(e[38]=[A("span",{class:"menu-icon"},"",-1),A("span",{class:"menu-label"},"",-1)])]),_:1},8,["onClick"]),W(i,{to:"/advanced-data-recovery",class:"menu-item",onClick:a.closeMobileMenu},{default:B(()=>[...e[39]||(e[39]=[A("span",{class:"menu-icon"},"",-1),A("span",{class:"menu-label"},"",-1)])]),_:1},8,["onClick"])])])])):ct("",!0),e[41]||(e[41]=A("footer",{class:"app-footer"},[A("p",null," 2024  - ")],-1))],2)}const Hi=$i(Mi,[["render",Bi]]),ve=Ss.createInstance({name:"number-prediction-db",storeName:"prediction-records"}),Me=Ss.createInstance({name:"lottery-history-db",storeName:"lottery-records"}),Ui=fa({state(){return{numberCombinations:[],currentCombination:"",generationMethod:"random",betAmount:10,multiplier:1,lotteryResult:"",lotteryPeriod:"",predictionResult:"",totalInvestment:0,totalOutput:0,historyRecords:[],lotteryHistorySize:3,lotteryHistoryRecords:[],aiPredictionResult:null,isPredicting:!1}},mutations:{setCurrentCombination(s,e){s.currentCombination=e},setGenerationMethod(s,e){s.generationMethod=e},setMultiplier(s,e){s.multiplier=e},setLotteryResult(s,{result:e,period:t}){s.lotteryResult=e,s.lotteryPeriod=t},addHistoryRecord(s,e){s.historyRecords.unshift(e),s.totalInvestment+=e.investment,s.totalOutput+=e.output},setHistoryRecords(s,e){s.historyRecords=e},deleteHistoryRecord(s,e){const t=s.historyRecords.findIndex(n=>n.id===e);if(t!==-1){const n=s.historyRecords[t];s.historyRecords.splice(t,1),s.totalInvestment-=n.investment,s.totalOutput-=n.output}},setLotteryPeriod(s,e){s.lotteryPeriod=e},setTotalInvestment(s,e){s.totalInvestment=e},setTotalOutput(s,e){s.totalOutput=e},setLotteryHistorySize(s,e){s.lotteryHistorySize=e},setLotteryHistoryRecords(s,e){s.lotteryHistoryRecords=e},setAIPredictionResult(s,e){s.aiPredictionResult=e},setPredictingStatus(s,e){s.isPredicting=e}},actions:{fetchLatestLotteryResult(t){return _(this,arguments,function*({commit:s,state:e}){const n=r=>r&&r.timestamp&&Date.now()-r.timestamp<864e5;try{const r=`lottery_history_${e.lotteryHistorySize}`,a=yield ve.getItem(r);if(a&&n(a))return console.log(""),s("setLotteryResult",{result:a.lotteryData.result,period:a.lotteryData.period}),s("setLotteryHistoryRecords",a.lotteryHistoryRecords),a.lotteryData;const i=new Date,l=i.getFullYear(),p=String(i.getMonth()+1).padStart(2,"0"),d=String(i.getDate()).padStart(2,"0"),w="zsm9fvjchgeegusq",f="GDfu7jmtIM8kyZpisLe0uGsf7gEPVo5S",m=e.lotteryHistorySize,y=yield fetch(`https://www.mxnzp.com/api/lottery/common/history?code=fc3d&size=${m}&app_id=${w}&app_secret=${f}`);if(!y.ok)throw new Error("");const C=yield y.json();console.log(C);let P,v=[];if(C&&C.code===1&&C.data){const D=Array.isArray(C.data)?C.data:[C.data],O=D[0];P={period:O.expect,result:O.openCode?O.openCode.replace(/\s+/g,""):"",date:O.time},v=D.map(T=>({period:T.expect,result:T.openCode?T.openCode.replace(/\s+/g,""):"",date:T.time}))}else throw new Error(`API: ${C?C.msg:""}`);s("setLotteryResult",{result:P.result,period:P.period}),s("setLotteryHistoryRecords",v);const k={lotteryData:P,lotteryHistoryRecords:v,timestamp:Date.now()};return yield ve.setItem(r,k),yield this.dispatch("saveLotteryHistoryRecords",v),P}catch(r){console.error(":",r);const a=new Date,i=a.getFullYear(),l=Math.floor(Math.random()*100)+1,p=String(Math.floor(Math.random()*1e3)).padStart(3,"0"),d={period:`${i}${String(l).padStart(3,"0")}`,result:p,date:a.toLocaleDateString()};return s("setLotteryResult",{result:d.result,period:d.period}),d}})},generateRandomCombination({commit:s,state:e}){const t=[];for(;t.length<5;){const r=Math.floor(Math.random()*10);t.includes(r)||t.push(r)}const n=t.join("");s("setCurrentCombination",n),s("setGenerationMethod","random"),e.numberCombinations.includes(n)||e.numberCombinations.push(n)},setManualCombination({commit:s,state:e},t){return t.length===5&&/^\d{5}$/.test(t)&&new Set(t).size===5?(s("setCurrentCombination",t),s("setGenerationMethod","manual"),e.numberCombinations.includes(t)||e.numberCombinations.push(t),!0):!1},performAIPrediction(n){return _(this,arguments,function*({commit:s,state:e,dispatch:t}){try{if(s("setPredictingStatus",!0),e.lotteryHistoryRecords.length===0)throw new Error("");const r=yield xi.predictNextLottery(e.lotteryHistoryRecords);return s("setAIPredictionResult",r),r.prediction&&(s("setCurrentCombination",r.prediction),s("setGenerationMethod","ai"),e.lotteryResult&&(yield t("performPrediction"))),r}catch(r){throw console.error("AI:",r),r}finally{s("setPredictingStatus",!1)}})},performPrediction(t){return _(this,arguments,function*({commit:s,state:e}){if(!e.currentCombination||!e.lotteryResult)return;let n=e.lotteryResult;if(n=n.replace(/\D/g,""),!/^\d{3}$/.test(n)){const d=n.match(/\d{3}/);if(d)n=d[0];else throw new Error("3")}const r=e.currentCombination===n,a=r?"":"",i=e.betAmount*e.multiplier,l=r?160*e.multiplier:0,p={id:Date.now(),period:e.lotteryPeriod,combination:e.currentCombination,generationMethod:e.generationMethod,lotteryResult:n,predictionResult:a,investment:i,output:l,multiplier:e.multiplier,timestamp:new Date().toLocaleString()};return s("addHistoryRecord",p),yield ve.setItem(p.id.toString(),p),yield this.dispatch("loadHistoryRecords"),a})},loadHistoryRecords(e){return _(this,arguments,function*({commit:s}){try{const t=[];yield ve.iterate((a,i)=>{t.push(a)}),t.sort((a,i)=>i.id-a.id),s("setHistoryRecords",t);const n=t.reduce((a,i)=>a+i.investment,0),r=t.reduce((a,i)=>a+i.output,0);return s("setTotalInvestment",n),s("setTotalOutput",r),{totalInvestment:n,totalOutput:r}}catch(t){throw console.error(":",t),new Error("")}})},deleteHistoryRecord(n,r){return _(this,arguments,function*({commit:s,state:e},t){try{return yield ve.removeItem(t.toString()),s("deleteHistoryRecord",t),yield this.dispatch("loadHistoryRecords"),!0}catch(a){throw console.error(":",a),new Error("")}})},clearAllHistoryRecords(e){return _(this,arguments,function*({commit:s}){try{return yield ve.clear(),s("setHistoryRecords",[]),s("setTotalInvestment",0),s("setTotalOutput",0),!0}catch(t){throw console.error(":",t),new Error("")}})},clearLotteryCache(){return _(this,null,function*(){try{const e=(yield ve.keys()).filter(t=>t.startsWith("lottery_history_"));for(const t of e)yield ve.removeItem(t);return console.log(` ${e.length} `),e.length}catch(s){throw console.error(":",s),new Error("")}})},saveLotteryHistoryRecords(t,n){return _(this,arguments,function*({commit:s},e){try{if(!e||e.length===0)return;const r=e.map(a=>_(this,null,function*(){const i=`lottery_record_${a.period}`,l=yield Me.getItem(i);(!l||l.date!==a.date)&&(yield Me.setItem(i,u(o({},a),{savedAt:Date.now(),id:i})),console.log(`${a.period}`))}));return yield Promise.all(r),console.log(` ${e.length} `),e.length}catch(r){throw console.error(":",r),new Error("")}})},loadLotteryHistoryRecords(e){return _(this,arguments,function*({commit:s}){try{const t=[],a=(yield Me.keys()).filter(i=>i.startsWith("lottery_record_")).map(i=>_(this,null,function*(){const l=yield Me.getItem(i);l&&t.push(l)}));return yield Promise.all(a),t.sort((i,l)=>{const p=parseInt(i.period.replace(/\D/g,""));return parseInt(l.period.replace(/\D/g,""))-p}),console.log(` ${t.length} `),t}catch(t){throw console.error(":",t),new Error("")}})},clearPersistedLotteryHistory(){return _(this,null,function*(){try{const e=(yield Me.keys()).filter(t=>t.startsWith("lottery_record_"));for(const t of e)yield Me.removeItem(t);return console.log(` ${e.length} `),e.length}catch(s){throw console.error(":",s),new Error("")}})}},getters:{totalProfit:s=>s.totalOutput-s.totalInvestment,roi:s=>s.totalInvestment>0?(s.totalOutput/s.totalInvestment*100).toFixed(2):"0.00"}}),ji=ma({history:pa(),routes:[{path:"/",redirect:"/ai-prediction"},{path:"/ai-prediction",component:()=>Y(()=>import("./AIPredictionMenu-B8gZhgUO.js"),__vite__mapDeps([0,1,2,3]),import.meta.url)},{path:"/betting-records",component:()=>Y(()=>import("./BettingRecordsMenu-DeWkmIyl.js"),__vite__mapDeps([4,1,2,5]),import.meta.url)},{path:"/number-extraction",component:()=>Y(()=>import("./NumberExtraction-BTu7BcBC.js"),__vite__mapDeps([6,2,1,7]),import.meta.url)},{path:"/four-code-maintenance",component:()=>Y(()=>import("./FourCodeMaintenance-DRglBgel.js"),__vite__mapDeps([8,2,1,9]),import.meta.url)},{path:"/kill-code-maintenance",component:()=>Y(()=>import("./KillCodeMaintenance-C9OhsB5V.js"),__vite__mapDeps([10,2,1,11]),import.meta.url)},{path:"/five-code-maintenance",component:()=>Y(()=>import("./FiveCodeMaintenance-jPpJS9Kj.js"),__vite__mapDeps([12,2,1,13]),import.meta.url)},{path:"/code-maintenance",component:()=>Y(()=>import("./CodeMaintenance-BVhY1lWU.js"),__vite__mapDeps([14,2,1,15]),import.meta.url)},{path:"/match-four-code-by-danma",component:()=>Y(()=>import("./MatchFourCodeByDanma-D4fMliIz.js"),__vite__mapDeps([16,2,1,17]),import.meta.url)},{path:"/advanced-prediction",component:()=>Y(()=>import("./AdvancedNumberPrediction-Cyd20C6j.js"),__vite__mapDeps([18,2,1,19]),import.meta.url)},{path:"/kill-two-code-maintenance",component:()=>Y(()=>import("./KillTwoCodeMaintenance-CiFrsKBo.js"),__vite__mapDeps([20,2,1,21]),import.meta.url)},{path:"/data-recovery",component:()=>Y(()=>import("./DataRecovery-DHtA9pXg.js"),__vite__mapDeps([22,2,1,23]),import.meta.url)},{path:"/advanced-data-recovery",component:()=>Y(()=>import("./AdvancedDataRecovery-zwdWcX-g.js"),__vite__mapDeps([24,2,1,25]),import.meta.url)},{path:"/three-code-deduplication",component:()=>Y(()=>import("./ThreeCodeDeduplication-Bgu3P_LO.js"),__vite__mapDeps([26,1,2,27]),import.meta.url)},{path:"/period-management",component:()=>Y(()=>import("./PeriodManagement-DJwzyXpl.js"),__vite__mapDeps([28,2,1,29]),import.meta.url)},{path:"/three-code-filter",component:()=>Y(()=>import("./ThreeCodeFilter-IF_a5_Qd.js"),__vite__mapDeps([30,2,1,31]),import.meta.url)},{path:"/:pathMatch(.*)*",component:()=>Y(()=>import("./NotFound-BUSUCSnz.js"),__vite__mapDeps([32,1,2,33]),import.meta.url)}]}),Qt=ga(Hi);Qt.use(Ui);Qt.use(ji);Qt.mixin({beforeMount(){return _(this,null,function*(){if(this.$store){yield this.$store.dispatch("loadHistoryRecords"),typeof window!="undefined"&&(ki(),Ci(),Ii(),setTimeout(()=>{et(),Ei(),Pi()},200));try{const s=yield this.$store.dispatch("loadLotteryHistoryRecords");if(s&&s.length>0&&this.$store.state.lotteryHistoryRecords.length===0&&(this.$store.commit("setLotteryHistoryRecords",s),s[0])){const t=s[0];this.$store.commit("setLotteryResult",{result:t.result,period:t.period})}}catch(s){console.warn(":",s)}}})}});Qt.mount("#app");export{$i as _,xi as a};
