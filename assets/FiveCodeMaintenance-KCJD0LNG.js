var S=Object.defineProperty,w=Object.defineProperties;var I=Object.getOwnPropertyDescriptors;var g=Object.getOwnPropertySymbols;var R=Object.prototype.hasOwnProperty,P=Object.prototype.propertyIsEnumerable;var C=(i,e,o)=>e in i?S(i,e,{enumerable:!0,configurable:!0,writable:!0,value:o}):i[e]=o,y=(i,e)=>{for(var o in e||(e={}))R.call(e,o)&&C(i,o,e[o]);if(g)for(var o of g(e))P.call(e,o)&&C(i,o,e[o]);return i},b=(i,e)=>w(i,I(e));var p=(i,e,o)=>new Promise((d,s)=>{var n=a=>{try{f(o.next(a))}catch(v){s(v)}},r=a=>{try{f(o.throw(a))}catch(v){s(v)}},f=a=>a.done?d(a.value):Promise.resolve(a.value).then(n,r);f((o=o.apply(i,e)).next())});import{l as M}from"./utils-DurHG9wo.js";import{c as u,a as t,t as l,w as k,l as m,v as h,D as x,k as T,b as D,F,B as _,o as c,n as L}from"./vendor-XXQc_yx5.js";import{_ as N}from"./index-BXDNWbx7.js";const V={name:"FiveCodeMaintenance",data(){return{records:[],formData:{period:"",fiveCode:"",priority:"3"},editingId:null,searchTerm:"",currentPage:1,pageSize:10,fiveCodeMaintenanceStorage:null}},computed:{filteredRecords(){let i=this.records;if(this.searchTerm){const o=this.searchTerm.toLowerCase();i=i.filter(d=>d.period.toLowerCase().includes(o)||d.fiveCode.toLowerCase().includes(o))}i.sort((o,d)=>d.period.localeCompare(o.period));const e=(this.currentPage-1)*this.pageSize;return i.slice(e,e+this.pageSize)},totalPages(){let i=this.records;if(this.searchTerm){const e=this.searchTerm.toLowerCase();i=i.filter(o=>o.period.toLowerCase().includes(e)||o.fiveCode.toLowerCase().includes(e))}return Math.ceil(i.length/this.pageSize)}},mounted(){this.fiveCodeMaintenanceStorage=M.createInstance({name:"numberPrediction",storeName:"fiveCodeMaintenance"}),this.loadRecords()},methods:{loadRecords(){return p(this,null,function*(){try{const i=yield this.fiveCodeMaintenanceStorage.getItem("fiveCodeRecords");this.records=i||[]}catch(i){console.error("加载五胆码记录失败:",i),alert("加载失败，请刷新页面重试")}})},saveRecord(){return p(this,null,function*(){if(this.validateFiveCode())try{if(this.editingId){const e=this.records.findIndex(o=>o.id===this.editingId);e!==-1&&(this.records[e]=b(y({},this.records[e]),{fiveCode:this.formData.fiveCode,priority:this.formData.priority,updatedAt:new Date().toISOString()}))}else{const e={id:Date.now().toString(),period:this.formData.period,fiveCode:this.formData.fiveCode,priority:this.formData.priority,createdAt:new Date().toISOString(),updatedAt:new Date().toISOString()};this.records.push(e)}const i=JSON.parse(JSON.stringify(this.records));yield this.fiveCodeMaintenanceStorage.setItem("fiveCodeRecords",i),this.resetForm(),alert(this.editingId?"编辑成功":"添加成功")}catch(i){console.error("保存记录失败:",i),alert("保存失败，请重试")}})},editRecord(i){this.editingId=i.id,this.formData={period:i.period,fiveCode:i.fiveCode,priority:i.priority},window.scrollTo({top:0,behavior:"smooth"})},deleteRecord(i){return p(this,null,function*(){if(confirm("确定要删除这条记录吗？"))try{this.records=this.records.filter(e=>e.id!==i),yield this.fiveCodeMaintenanceStorage.setItem("fiveCodeRecords",this.records),alert("删除成功")}catch(e){console.error("删除记录失败:",e),alert("删除失败，请重试")}})},cancelEdit(){this.resetForm()},resetForm(){this.editingId=null,this.formData={period:"",fiveCode:"",priority:"3"},this.currentPage=1},validateFiveCode(){if(this.formData.fiveCode.length!==5)return alert("请输入5个数字"),!1;for(const e of this.formData.fiveCode)if(!/^[0-9]$/.test(e))return alert("每个数字必须是0-9之间的单个数字"),!1;return[...new Set(this.formData.fiveCode)].length!==5?(alert("请确保5个数字不重复"),!1):!0},getPriorityText(i){return{1:"最高",2:"高",3:"中",4:"低",5:"最低"}[i]||"未知"},formatDate(i){return new Date(i).toLocaleString("zh-CN",{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit"})}}},z={class:"five-code-maintenance"},q={class:"form-section"},O={class:"form-group"},A=["disabled"],B={class:"form-group"},E={class:"form-group"},U={class:"form-actions"},J={class:"table-section"},j={class:"search-group"},G={class:"data-table"},H={class:"action-buttons"},K=["onClick"],Q=["onClick"],W={key:0},X={key:0,class:"pagination"},Y=["disabled"],Z={class:"page-info"},$=["disabled"];function ee(i,e,o,d,s,n){return c(),u("div",z,[e[17]||(e[17]=t("h2",null,"五胆码组合维护",-1)),e[18]||(e[18]=t("p",null,"管理不同期号的五胆码组合，设置优先级，用于数字预测",-1)),t("div",q,[t("h3",null,l(s.editingId?"编辑五胆码":"添加五胆码"),1),t("form",{onSubmit:e[4]||(e[4]=k((...r)=>n.saveRecord&&n.saveRecord(...r),["prevent"]))},[t("div",O,[e[8]||(e[8]=t("label",{for:"period"},"期号 *",-1)),m(t("input",{id:"period","onUpdate:modelValue":e[0]||(e[0]=r=>s.formData.period=r),type:"text",placeholder:"请输入期号，如：2024001",disabled:s.editingId,required:""},null,8,A),[[h,s.formData.period]])]),t("div",B,[e[9]||(e[9]=t("label",{for:"fiveCode"},"五胆码 *",-1)),m(t("input",{id:"fiveCode","onUpdate:modelValue":e[1]||(e[1]=r=>s.formData.fiveCode=r),type:"text",placeholder:"请输入5个数字",required:""},null,512),[[h,s.formData.fiveCode]]),e[10]||(e[10]=t("div",{class:"form-hint"},"请确保输入5个不同的数字，范围0-9",-1))]),t("div",E,[e[12]||(e[12]=t("label",{for:"priority"},"优先级 *",-1)),m(t("select",{id:"priority","onUpdate:modelValue":e[2]||(e[2]=r=>s.formData.priority=r),required:""},[...e[11]||(e[11]=[T('<option value="1" data-v-d9f8ed9a>1 - 最高</option><option value="2" data-v-d9f8ed9a>2 - 高</option><option value="3" data-v-d9f8ed9a>3 - 中</option><option value="4" data-v-d9f8ed9a>4 - 低</option><option value="5" data-v-d9f8ed9a>5 - 最低</option>',5)])],512),[[x,s.formData.priority]])]),t("div",U,[e[13]||(e[13]=t("button",{type:"submit",class:"btn-primary"},"保存",-1)),t("button",{type:"button",class:"btn-secondary",onClick:e[3]||(e[3]=(...r)=>n.cancelEdit&&n.cancelEdit(...r))},"取消")])],32)]),t("div",J,[e[16]||(e[16]=t("h3",null,"五胆码组合列表",-1)),t("div",j,[m(t("input",{"onUpdate:modelValue":e[5]||(e[5]=r=>s.searchTerm=r),type:"text",placeholder:"搜索期号或五胆码...",class:"search-input"},null,512),[[h,s.searchTerm]])]),t("table",G,[e[15]||(e[15]=t("thead",null,[t("tr",null,[t("th",null,"期号"),t("th",null,"五胆码"),t("th",null,"优先级"),t("th",null,"创建时间"),t("th",null,"操作")])],-1)),t("tbody",null,[(c(!0),u(F,null,_(n.filteredRecords,r=>(c(),u("tr",{key:r.id},[t("td",null,l(r.period),1),t("td",null,l(r.fiveCode),1),t("td",null,[t("span",{class:L(["priority-badge",`priority-${r.priority}`])},l(n.getPriorityText(r.priority)),3)]),t("td",null,l(n.formatDate(r.createdAt)),1),t("td",H,[t("button",{class:"btn-edit",onClick:f=>n.editRecord(r)},"编辑",8,K),t("button",{class:"btn-delete",onClick:f=>n.deleteRecord(r.id)},"删除",8,Q)])]))),128))]),n.filteredRecords.length===0?(c(),u("tfoot",W,[...e[14]||(e[14]=[t("tr",null,[t("td",{colspan:"5",class:"no-data"},"暂无数据")],-1)])])):D("",!0)]),n.totalPages>1?(c(),u("div",X,[t("button",{onClick:e[6]||(e[6]=r=>s.currentPage--),disabled:s.currentPage===1,class:"btn-pagination"}," 上一页 ",8,Y),t("span",Z," 第 "+l(s.currentPage)+" / "+l(n.totalPages)+" 页 ",1),t("button",{onClick:e[7]||(e[7]=r=>s.currentPage++),disabled:s.currentPage===n.totalPages,class:"btn-pagination"}," 下一页 ",8,$)])):D("",!0)])])}const se=N(V,[["render",ee],["__scopeId","data-v-d9f8ed9a"]]);export{se as default};
